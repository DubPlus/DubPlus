/*!
     /#######            /##                
    | ##__  ##          | ##          /##   
    | ##  \ ## /##   /##| #######    | ##   
    | ##  | ##| ##  | ##| ##__  ## /########
    | ##  | ##| ##  | ##| ##  \ ##|__  ##__/
    | ##  | ##| ##  | ##| ##  | ##   | ##   
    | #######/|  ######/| #######/   |__/   
    |_______/  \______/ |_______/           
                                            
                                            
    https://github.com/DubPlus/DubPlus

    v4.1.2

    MIT License 

    Copyright (c) 2025 DubPlus

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.
*/
var dubplus=function(){"use strict";var e,t,n,o,i,s,r,a,l,u,c,d,f,p,m=Object.defineProperty,v=e=>{throw TypeError(e)},h=(e,t,n)=>((e,t,n)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n),b=(e,t,n)=>t.has(e)||v("Cannot "+n),g=(e,t,n)=>(b(e,t,"read from private field"),n?n.call(e):t.get(e)),w=(e,t,n)=>t.has(e)?v("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),y=(e,t,n,o)=>(b(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n),k=(e,t,n)=>(b(e,t,"access private method"),n);const x=!1;var E=Array.isArray,_=Array.prototype.indexOf,S=Array.from,O=Object.defineProperty,C=Object.getOwnPropertyDescriptor,U=Object.getOwnPropertyDescriptors,M=Object.prototype,L=Array.prototype,z=Object.getPrototypeOf,Q=Object.isExtensible;const $=()=>{};function A(e){return e()}function I(e){for(var t=0;t<e.length;t++)e[t]()}const T=32,N=64,D=256,q=512,j=1024,P=2048,F=4096,B=8192,V=16384,R=32768,W=65536,J=1<<17,K=1<<19,H=1<<20,Y=1<<21,X=1<<22,G=1<<23,Z=Symbol("$state"),ee=Symbol(""),te=new class extends Error{constructor(){super(...arguments),h(this,"name","StaleReactionError"),h(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function ne(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}const oe=Symbol(),ie="http://www.w3.org/1999/xhtml";function se(e){return e===this.v}function re(e,t){return e!=e?t==t:e!==t||null!==e&&"object"==typeof e||"function"==typeof e}function ae(e){return!re(e,this.v)}let le=!1;let ue=null;function ce(e){ue=e}function de(e,t=!1,n){ue={p:ue,c:null,e:null,s:e,x:null,l:le&&!t?{s:null,u:null,$:[]}:null}}function fe(e){var t=ue,n=t.e;if(null!==n)for(var o of(t.e=null,n))dt(o);return ue=t.p,{}}function pe(){return!le||null!==ue&&null===ue.l}const me=new WeakMap;function ve(e,t){for(;null!==t;){if(128&t.f)try{return void t.b.error(e)}catch(t){e=t}t=t.parent}throw e instanceof Error&&he(e),e}function he(e){const t=me.get(e);t&&(O(e,"message",{value:t.message}),O(e,"stack",{value:t.stack}))}let be=[];function ge(){var e=be;be=[],I(e)}function we(e){0===be.length&&queueMicrotask(ge),be.push(e)}function ye(){for(var e=Qt.b;null!==e&&!e.has_pending_snippet();)e=e.parent;return null===e&&function(){throw new Error("https://svelte.dev/e/await_outside_boundary")}(),e}function ke(e){var t=2050,n=null!==Mt&&2&Mt.f?Mt:null;null===Qt||null!==n&&0!==(n.f&D)?t|=D:Qt.f|=K;return{ctx:ue,deps:null,effects:null,equals:se,f:t,fn:e,reactions:null,rv:0,v:oe,wv:0,parent:n??Qt,ac:null}}function xe(e,t){let n=Qt;null===n&&function(){throw new Error("https://svelte.dev/e/async_derived_orphan")}();var o=n.b,i=void 0,s=Ve(oe),r=null,a=!Mt;return function(e){ut(4718592,e,!0)}(()=>{try{var t=e()}catch(e){t=Promise.reject(e)}var n=()=>t;i=(null==r?void 0:r.then(n,n))??Promise.resolve(t),r=i;var l=ze,u=o.pending;a&&(o.update_pending_count(1),u||l.increment());const c=(e,t=void 0)=>{r=null,u||l.activate(),t?t!==te&&(s.f|=G,Ke(s,t)):(0!==(s.f&G)&&(s.f^=G),Ke(s,e)),a&&(o.update_pending_count(-1),u||l.decrement()),Me()};if(i.then(c,e=>c(null,e||"unknown")),l)return()=>{queueMicrotask(()=>l.neuter())}}),new Promise(e=>{!function t(n){function o(){n===i?e(s):t(i)}n.then(o,o)}(i)})}function Ee(e){const t=ke(e);return It(t),t}function _e(e){const t=ke(e);return t.equals=ae,t}function Se(e){var t=e.effects;if(null!==t){e.effects=null;for(var n=0;n<t.length;n+=1)gt(t[n])}}function Oe(e){var t,n=Qt;$t(function(e){for(var t=e.parent;null!==t;){if(!(2&t.f))return t;t=t.parent}return null}(e));try{Se(e),t=Jt(e)}finally{$t(n)}return t}function Ce(e){var t=Oe(e);(e.equals(t)||(e.v=t,e.wv=Vt()),Ct)||(null!==Qe?Qe.set(e,e.v):tn(e,!Bt&&0===(e.f&D)||null===e.deps?j:F))}function Ue(e,t,n){const o=pe()?ke:_e;if(0!==t.length){var i,s,r,a=ze,l=Qt,u=(i=Qt,s=Mt,r=ue,function(){$t(i),zt(s),ce(r)}),c=ye();Promise.all(t.map(e=>xe(e))).then(t=>{null==a||a.activate(),u();try{n([...e.map(o),...t])}catch(e){0===(l.f&V)&&ve(e,l)}null==a||a.deactivate(),Me()}).catch(e=>{c.error(e)})}else n(e.map(o))}function Me(){$t(null),zt(null),ce(null)}const Le=new Set;let ze=null,Qe=null,$e=new Set,Ae=[];function Ie(){const e=Ae.shift();Ae.length>0&&queueMicrotask(Ie),e()}let Te=[],Ne=null,De=!1;e=new WeakMap,t=new WeakMap,n=new WeakMap,o=new WeakMap,i=new WeakMap,s=new WeakMap,r=new WeakMap,a=new WeakMap,l=new WeakMap,u=new WeakMap,c=new WeakSet,d=function(e){var t;e.f^=j;for(var n=e.first;null!==n;){var o=n.f,i=!!(96&o);if(!(i&&0!==(o&j)||0!==(o&B)||this.skipped_effects.has(n))&&null!==n.fn){if(i)n.f^=j;else if(4&o)g(this,l).push(n);else if(Rt(n)){if(0!==(o&X))((null==(t=n.b)?void 0:t.pending)?g(this,r):g(this,s)).push(n);else 16&n.f&&g(this,u).push(n),Yt(n)}var a=n.first;if(null!==a){n=a;continue}}var c=n.parent;for(n=n.next;null===n&&null!==c;)n=c.next,c=c.parent}},f=function(){if(!g(this,i))for(const e of g(this,t))e();g(this,t).clear()};let qe=class p{constructor(){w(this,c),h(this,"current",new Map),w(this,e,new Map),w(this,t,new Set),w(this,n,0),w(this,o,null),w(this,i,!1),w(this,s,[]),w(this,r,[]),w(this,a,[]),w(this,l,[]),w(this,u,[]),h(this,"skipped_effects",new Set)}process(t){var i;Te=[];var p=null;if(Le.size>1){p=new Map,Qe=new Map;for(const[e,t]of this.current)p.set(e,{v:e.v,wv:e.wv}),e.v=t;for(const t of Le)if(t!==this)for(const[n,o]of g(t,e))p.has(n)||(p.set(n,{v:n.v,wv:n.wv}),n.v=o)}for(const e of t)k(this,c,d).call(this,e);if(0===g(this,s).length&&0===g(this,n)){k(this,c,f).call(this);var m=g(this,a),v=g(this,l);y(this,a,[]),y(this,l,[]),y(this,u,[]),ze=null,Pe(m),Pe(v),null===ze?ze=this:Le.delete(this),null==(i=g(this,o))||i.resolve()}else{for(const e of g(this,a))tn(e,j);for(const e of g(this,l))tn(e,j);for(const e of g(this,u))tn(e,j)}if(p){for(const[e,{v:t,wv:n}]of p)e.wv<=n&&(e.v=t);Qe=null}for(const e of g(this,s))Yt(e);for(const e of g(this,r))Yt(e);y(this,s,[]),y(this,r,[])}capture(t,n){g(this,e).has(t)||g(this,e).set(t,n),this.current.set(t,t.v)}activate(){ze=this}deactivate(){ze=null;for(const e of $e)if($e.delete(e),e(),null!==ze)break}neuter(){y(this,i,!0)}flush(){Te.length>0?function(){var e=St;De=!0;try{var t=0;for(Ot(!0);Te.length>0;){var n=qe.ensure();if(t++>1e3)x,je();n.process(Te),Be.clear()}}finally{De=!1,Ot(e),Ne=null}}():k(this,c,f).call(this),ze===this&&(0===g(this,n)&&Le.delete(this),this.deactivate())}increment(){y(this,n,g(this,n)+1)}decrement(){if(y(this,n,g(this,n)-1),0===g(this,n)){for(const e of this.current.keys())Ye(e,P,!1);y(this,a,[]),y(this,l,[]),this.flush()}else this.deactivate()}add_callback(e){g(this,t).add(e)}settled(){return(g(this,o)??y(this,o,{promise:new Promise((n,o)=>{e=n,t=o}),resolve:e,reject:t})).promise;var e,t}static ensure(){if(null===ze){const e=ze=new p;Le.add(ze),p.enqueue(()=>{ze===e&&e.flush()})}return ze}static enqueue(e){0===Ae.length&&queueMicrotask(Ie),Ae.unshift(e)}};function je(){try{!function(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}()}catch(e){ve(e,Ne)}}function Pe(e){var t=e.length;if(0!==t){for(var n=0;n<t;){var o=e[n++];if(!(24576&o.f)&&Rt(o)){var i=ze?ze.current.size:0;if(Yt(o),null===o.deps&&null===o.first&&null===o.nodes_start&&(null===o.teardown&&null===o.ac?wt(o):o.fn=null),null!==ze&&ze.current.size>i&&0!==(o.f&H))break}}for(;n<t;)Fe(e[n++])}}function Fe(e){for(var t=Ne=e;null!==t.parent;){var n=(t=t.parent).f;if(De&&t===Qt&&16&n)return;if(96&n){if(0===(n&j))return;t.f^=j}}Te.push(t)}const Be=new Map;function Ve(e,t){return{f:0,v:e,reactions:null,equals:se,rv:0,wv:0}}function Re(e,t){const n=Ve(e);return It(n),n}function We(e,t=!1,n=!0){var o;const i=Ve(e);return t||(i.equals=ae),le&&n&&null!==ue&&null!==ue.l&&((o=ue.l).s??(o.s=[])).push(i),i}function Je(e,t,n=!1){return null!==Mt&&(!Lt||0!==(Mt.f&J))&&pe()&&4325394&Mt.f&&!(null==At?void 0:At.includes(e))&&function(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}(),Ke(e,n?Xe(t):t)}function Ke(e,t){if(!e.equals(t)){var n=e.v;Ct?Be.set(e,t):Be.set(e,n),e.v=t,qe.ensure().capture(e,n),2&e.f&&(0!==(e.f&P)&&Oe(e),tn(e,0===(e.f&D)?j:F)),e.wv=Vt(),Ye(e,P),!pe()||null===Qt||0===(Qt.f&j)||96&Qt.f||(null===Dt?function(e){Dt=e}([e]):Dt.push(e))}return t}function He(e){Je(e,e.v+1)}function Ye(e,t,n=!0){var o=e.reactions;if(null!==o)for(var i=pe(),s=o.length,r=0;r<s;r++){var a=o[r],l=a.f;if(i||a!==Qt){var u=0===(l&P)&&(n||0===(l&X));u&&tn(a,t),2&l?Ye(a,F):u&&Fe(a)}}}function Xe(e){if("object"!=typeof e||null===e||Z in e)return e;const t=z(e);if(t!==M&&t!==L)return e;var n=new Map,o=E(e),i=Re(0),s=Pt,r=e=>{if(Pt===s)return e();var t=Mt,n=Pt;zt(null),Ft(s);var o=e();return zt(t),Ft(n),o};return o&&n.set("length",Re(e.length)),new Proxy(e,{defineProperty(e,t,o){"value"in o&&!1!==o.configurable&&!1!==o.enumerable&&!1!==o.writable||function(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}();var i=n.get(t);return void 0===i?i=r(()=>{var e=Re(o.value);return n.set(t,e),e}):Je(i,o.value,!0),!0},deleteProperty(e,t){var o=n.get(t);if(void 0===o){if(t in e){const e=r(()=>Re(oe));n.set(t,e),He(i)}}else Je(o,oe),He(i);return!0},get(t,o,i){var s;if(o===Z)return e;var a=n.get(o),l=o in t;if(void 0!==a||l&&!(null==(s=C(t,o))?void 0:s.writable)||(a=r(()=>Re(Xe(l?t[o]:oe))),n.set(o,a)),void 0!==a){var u=Xt(a);return u===oe?void 0:u}return Reflect.get(t,o,i)},getOwnPropertyDescriptor(e,t){var o=Reflect.getOwnPropertyDescriptor(e,t);if(o&&"value"in o){var i=n.get(t);i&&(o.value=Xt(i))}else if(void 0===o){var s=n.get(t),r=null==s?void 0:s.v;if(void 0!==s&&r!==oe)return{enumerable:!0,configurable:!0,value:r,writable:!0}}return o},has(e,t){var o;if(t===Z)return!0;var i=n.get(t),s=void 0!==i&&i.v!==oe||Reflect.has(e,t);if((void 0!==i||null!==Qt&&(!s||(null==(o=C(e,t))?void 0:o.writable)))&&(void 0===i&&(i=r(()=>Re(s?Xe(e[t]):oe)),n.set(t,i)),Xt(i)===oe))return!1;return s},set(e,t,s,a){var l,u=n.get(t),c=t in e;if(o&&"length"===t)for(var d=s;d<u.v;d+=1){var f=n.get(d+"");void 0!==f?Je(f,oe):d in e&&(f=r(()=>Re(oe)),n.set(d+"",f))}void 0===u?c&&!(null==(l=C(e,t))?void 0:l.writable)||(Je(u=r(()=>Re(void 0)),Xe(s)),n.set(t,u)):(c=u.v!==oe,Je(u,r(()=>Xe(s))));var p=Reflect.getOwnPropertyDescriptor(e,t);if((null==p?void 0:p.set)&&p.set.call(a,s),!c){if(o&&"string"==typeof t){var m=n.get("length"),v=Number(t);Number.isInteger(v)&&v>=m.v&&Je(m,v+1)}He(i)}return!0},ownKeys(e){Xt(i);var t=Reflect.ownKeys(e).filter(e=>{var t=n.get(e);return void 0===t||t.v!==oe});for(var[o,s]of n)s.v===oe||o in e||t.push(o);return t},setPrototypeOf(){!function(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}()}})}var Ge,Ze,et,tt;function nt(e=""){return document.createTextNode(e)}function ot(e){return et.call(e)}function it(e){return tt.call(e)}function st(e,t){return ot(e)}function rt(e,t){var n=ot(e);return n instanceof Comment&&""===n.data?it(n):n}function at(e,t=1,n=!1){let o=e;for(;t--;)o=it(o);return o}function lt(e){null===Qt&&null===Mt&&function(){throw new Error("https://svelte.dev/e/effect_orphan")}(),null!==Mt&&0!==(Mt.f&D)&&null===Qt&&function(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}(),Ct&&function(){throw new Error("https://svelte.dev/e/effect_in_teardown")}()}function ut(e,t,n,o=!0){var i=Qt;null!==i&&0!==(i.f&B)&&(e|=B);var s={ctx:ue,deps:null,nodes_start:null,nodes_end:null,f:e|P,first:null,fn:t,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Yt(s),s.f|=R}catch(e){throw gt(s),e}else null!==t&&Fe(s);if(!(n&&null===s.deps&&null===s.first&&null===s.nodes_start&&null===s.teardown&&0===(s.f&K))&&o&&(null!==i&&function(e,t){var n=t.last;null===n?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}(s,i),null!==Mt&&2&Mt.f)){var r=Mt;(r.effects??(r.effects=[])).push(s)}return s}function ct(e){lt();var t=Qt.f;if(!(!Mt&&0!==(t&T)&&0===(t&R)))return dt(e);var n=ue;(n.e??(n.e=[])).push(e)}function dt(e){return ut(1048580,e,!1)}function ft(e,t=0){return ut(8|t,e,!0)}function pt(e,t=[],n=[]){Ue(t,n,t=>{ut(8,()=>e(...t.map(Xt)),!0)})}function mt(e,t=0){return ut(16|t,e,!0)}function vt(e,t=!0){return ut(T,e,!0,t)}function ht(e){var t=e.teardown;if(null!==t){const e=Ct,n=Mt;Ut(!0),zt(null);try{t.call(null)}finally{Ut(e),zt(n)}}}function bt(e,t=!1){var n,o=e.first;for(e.first=e.last=null;null!==o;){null==(n=o.ac)||n.abort(te);var i=o.next;0!==(o.f&N)?o.parent=null:gt(o,t),o=i}}function gt(e,t=!0){var n=!1;(t||262144&e.f)&&null!==e.nodes_start&&null!==e.nodes_end&&(!function(e,t){for(;null!==e;){var n=e===t?null:it(e);e.remove(),e=n}}(e.nodes_start,e.nodes_end),n=!0),bt(e,t&&!n),Ht(e,0),tn(e,V);var o=e.transitions;if(null!==o)for(const e of o)e.stop();ht(e);var i=e.parent;null!==i&&null!==i.first&&wt(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function wt(e){var t=e.parent,n=e.prev,o=e.next;null!==n&&(n.next=o),null!==o&&(o.prev=n),null!==t&&(t.first===e&&(t.first=o),t.last===e&&(t.last=n))}function yt(e,t){var n=[];xt(e,n,!0),kt(n,()=>{gt(e),t&&t()})}function kt(e,t){var n=e.length;if(n>0){var o=()=>--n||t();for(var i of e)i.out(o)}else t()}function xt(e,t,n){if(0===(e.f&B)){if(e.f^=B,null!==e.transitions)for(const o of e.transitions)(o.is_global||n)&&t.push(o);for(var o=e.first;null!==o;){var i=o.next;xt(o,t,!!(0!==(o.f&W)||0!==(o.f&T))&&n),o=i}}}function Et(e){_t(e,!0)}function _t(e,t){if(0!==(e.f&B)){e.f^=B,0===(e.f&j)&&(tn(e,P),Fe(e));for(var n=e.first;null!==n;){var o=n.next;_t(n,!!(0!==(n.f&W)||0!==(n.f&T))&&t),n=o}if(null!==e.transitions)for(const n of e.transitions)(n.is_global||t)&&n.in()}}let St=!1;function Ot(e){St=e}let Ct=!1;function Ut(e){Ct=e}let Mt=null,Lt=!1;function zt(e){Mt=e}let Qt=null;function $t(e){Qt=e}let At=null;function It(e){null!==Mt&&(null===At?At=[e]:At.push(e))}let Tt=null,Nt=0,Dt=null;let qt=1,jt=0,Pt=jt;function Ft(e){Pt=e}let Bt=!1;function Vt(){return++qt}function Rt(e){var t,n=e.f;if(0!==(n&P))return!0;if(0!==(n&F)){var o=e.deps,i=0!==(n&D);if(null!==o){var s,r,a=0!==(n&q),l=i&&null!==Qt&&!Bt,u=o.length;if((a||l)&&(null===Qt||0===(Qt.f&V))){var c=e,d=c.parent;for(s=0;s<u;s++)r=o[s],!a&&(null==(t=null==r?void 0:r.reactions)?void 0:t.includes(c))||(r.reactions??(r.reactions=[])).push(c);a&&(c.f^=q),l&&null!==d&&0===(d.f&D)&&(c.f^=D)}for(s=0;s<u;s++)if(Rt(r=o[s])&&Ce(r),r.wv>e.wv)return!0}i&&(null===Qt||Bt)||tn(e,j)}return!1}function Wt(e,t,n=!0){var o=e.reactions;if(null!==o&&!(null==At?void 0:At.includes(e)))for(var i=0;i<o.length;i++){var s=o[i];2&s.f?Wt(s,t,!1):t===s&&(n?tn(s,P):0!==(s.f&j)&&tn(s,F),Fe(s))}}function Jt(e){var t,n=Tt,o=Nt,i=Dt,s=Mt,r=Bt,a=At,l=ue,u=Lt,c=Pt,d=e.f;Tt=null,Nt=0,Dt=null,Bt=0!==(d&D)&&(Lt||!St||null===Mt),Mt=96&d?null:e,At=null,ce(e.ctx),Lt=!1,Pt=++jt,null!==e.ac&&(e.ac.abort(te),e.ac=null);try{e.f|=Y;var f=(0,e.fn)(),p=e.deps;if(null!==Tt){var m;if(Ht(e,Nt),null!==p&&Nt>0)for(p.length=Nt+Tt.length,m=0;m<Tt.length;m++)p[Nt+m]=Tt[m];else e.deps=p=Tt;if(!Bt||2&d&&null!==e.reactions)for(m=Nt;m<p.length;m++)((t=p[m]).reactions??(t.reactions=[])).push(e)}else null!==p&&Nt<p.length&&(Ht(e,Nt),p.length=Nt);if(pe()&&null!==Dt&&!Lt&&null!==p&&!(6146&e.f))for(m=0;m<Dt.length;m++)Wt(Dt[m],e);return null!==s&&s!==e&&(jt++,null!==Dt&&(null===i?i=Dt:i.push(...Dt))),0!==(e.f&G)&&(e.f^=G),f}catch(e){return function(e){var t=Qt;if(null===t)return Mt.f|=G,e;if(0===(t.f&R)){if(!(128&t.f))throw!t.parent&&e instanceof Error&&he(e),e;t.b.error(e)}else ve(e,t)}(e)}finally{e.f^=Y,Tt=n,Nt=o,Dt=i,Mt=s,Bt=r,At=a,ce(l),Lt=u,Pt=c}}function Kt(e,t){let n=t.reactions;if(null!==n){var o=_.call(n,e);if(-1!==o){var i=n.length-1;0===i?n=t.reactions=null:(n[o]=n[i],n.pop())}}null===n&&2&t.f&&(null===Tt||!Tt.includes(t))&&(tn(t,F),768&t.f||(t.f^=q),Se(t),Ht(t,0))}function Ht(e,t){var n=e.deps;if(null!==n)for(var o=t;o<n.length;o++)Kt(e,n[o])}function Yt(e){var t=e.f;if(0===(t&V)){tn(e,j);var n=Qt,o=St;Qt=e,St=!0;try{16&t?function(e){for(var t=e.first;null!==t;){var n=t.next;0===(t.f&T)&&gt(t),t=n}}(e):bt(e),ht(e);var i=Jt(e);e.teardown="function"==typeof i?i:null,e.wv=qt}finally{St=o,Qt=n}}}function Xt(e){var t=!!(2&e.f);if(null===Mt||Lt){if(t&&null===e.deps&&null===e.effects){var n=e,o=n.parent;null!==o&&0===(o.f&D)&&(n.f^=D)}}else if(!(null!==Qt&&0!==(Qt.f&V))&&!(null==At?void 0:At.includes(e))){var i=Mt.deps;if(0!==(Mt.f&Y))e.rv<jt&&(e.rv=jt,null===Tt&&null!==i&&i[Nt]===e?Nt++:null===Tt?Tt=[e]:Bt&&Tt.includes(e)||Tt.push(e));else{(Mt.deps??(Mt.deps=[])).push(e);var s=e.reactions;null===s?e.reactions=[Mt]:s.includes(Mt)||s.push(Mt)}}if(Ct){if(Be.has(e))return Be.get(e);if(t){var r=(n=e).v;return(0===(n.f&j)&&null!==n.reactions||Gt(n))&&(r=Oe(n)),Be.set(n,r),r}}else if(t){if(n=e,null==Qe?void 0:Qe.has(n))return Qe.get(n);Rt(n)&&Ce(n)}if(0!==(e.f&G))throw e.v;return e.v}function Gt(e){if(e.v===oe)return!0;if(null===e.deps)return!1;for(const t of e.deps){if(Be.has(t))return!0;if(2&t.f&&Gt(t))return!0}return!1}function Zt(e){var t=Lt;try{return Lt=!0,e()}finally{Lt=t}}const en=-7169;function tn(e,t){e.f=e.f&en|t}function nn(e){if("object"==typeof e&&e&&!(e instanceof EventTarget))if(Z in e)on(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];"object"==typeof n&&n&&Z in n&&on(n)}}function on(e,t=new Set){if(!("object"!=typeof e||null===e||e instanceof EventTarget||t.has(e))){t.add(e),e instanceof Date&&e.getTime();for(let n in e)try{on(e[n],t)}catch(e){}const n=z(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const t=U(n);for(let n in t){const o=t[n].get;if(o)try{o.call(e)}catch(e){}}}}}const sn=["touchstart","touchmove"];function rn(e){return sn.includes(e)}let an=!1;function ln(e){var t=Mt,n=Qt;zt(null),$t(null);try{return e()}finally{zt(t),$t(n)}}function un(e,t,n,o=n){e.addEventListener(t,()=>ln(n));const i=e.__on_r;e.__on_r=i?()=>{i(),o(!0)}:()=>o(!0),an||(an=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const n of e.target.elements)null==(t=n.__on_r)||t.call(n)})},{capture:!0}))}const cn=new Set,dn=new Set;function fn(e,t,n,o,i){var s={capture:o,passive:i},r=function(e,t,n,o={}){function i(e){if(o.capture||mn.call(t,e),!e.cancelBubble)return ln(()=>null==n?void 0:n.call(this,e))}return e.startsWith("pointer")||e.startsWith("touch")||"wheel"===e?we(()=>{t.addEventListener(e,i,o)}):t.addEventListener(e,i,o),i}(e,t,n,s);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&function(e){const t=ut(8,null,!1);tn(t,j),t.teardown=e}(()=>{t.removeEventListener(e,r,s)})}function pn(e){for(var t=0;t<e.length;t++)cn.add(e[t]);for(var n of dn)n(e)}function mn(e){var t,n=this,o=n.ownerDocument,i=e.type,s=(null==(t=e.composedPath)?void 0:t.call(e))||[],r=s[0]||e.target,a=0,l=e.__root;if(l){var u=s.indexOf(l);if(-1!==u&&(n===document||n===window))return void(e.__root=n);var c=s.indexOf(n);if(-1===c)return;u<=c&&(a=u)}if((r=s[a]||e.target)!==n){O(e,"currentTarget",{configurable:!0,get:()=>r||o});var d=Mt,f=Qt;zt(null),$t(null);try{for(var p,m=[];null!==r;){var v=r.assignedSlot||r.parentNode||r.host||null;try{var h=r["__"+i];if(null!=h&&(!r.disabled||e.target===r))if(E(h)){var[b,...g]=h;b.apply(r,[e,...g])}else h.call(r,e)}catch(e){p?m.push(e):p=e}if(e.cancelBubble||v===n||null===v)break;r=v}if(p){for(let e of m)queueMicrotask(()=>{throw e});throw p}}finally{e.__root=n,delete e.currentTarget,zt(d),$t(f)}}}function vn(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","\x3c!----\x3e"),t.content}function hn(e,t){var n=Qt;null===n.nodes_start&&(n.nodes_start=e,n.nodes_end=t)}function bn(e,t){var n,o=!!(1&t),i=!!(2&t),s=!e.startsWith("<!>");return()=>{void 0===n&&(n=vn(s?e:"<!>"+e),o||(n=ot(n)));var t=i||Ze?document.importNode(n,!0):n.cloneNode(!0);o?hn(ot(t),t.lastChild):hn(t,t);return t}}function gn(e,t,n="svg"){var o,i=`<${n}>${!e.startsWith("<!>")?e:"<!>"+e}</${n}>`;return()=>{if(!o){var e=vn(i);o=ot(ot(e))}var t=o.cloneNode(!0);return hn(t,t),t}}function wn(e,t){return gn(e,0,"svg")}function yn(e=""){var t=nt(e+"");return hn(t,t),t}function kn(){var e=document.createDocumentFragment(),t=document.createComment(""),n=nt();return e.append(t,n),hn(t,n),e}function xn(e,t){null!==e&&e.before(t)}function En(e,t){var n=null==t?"":"object"==typeof t?t+"":t;n!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=n,e.nodeValue=n+"")}const _n=new Map;let Sn=new WeakMap;function On(e,t,n=!1){var o=e,i=null,s=null,r=oe,a=!1;const l=(e,t=!0)=>{a=!0,d(t,e)};var u=null;function c(){null!==u&&(u.lastChild.remove(),o.before(u),u=null);var e=r?i:s,t=r?s:i;e&&Et(e),t&&yt(t,()=>{r?s=null:i=null})}const d=(e,t)=>{if(r!==(r=e)){var n=!1,a=o;n,r?i??(i=t&&vt(()=>t(a))):s??(s=t&&vt(()=>t(a))),c()}};mt(()=>{a=!1,t(l),a||d(null,null)},n?W:0)}function Cn(e,t,n,o,i,s=null){var r=e,a={flags:t,items:new Map,first:null};!(4&t)||(r=e.appendChild(nt()));var l,u,c=null,d=!1,f=new Map,p=_e(()=>{var e=n();return E(e)?e:null==e?[]:S(e)});function m(){!function(e,t,n,o,i,s,r,a,l){var u,c,d,f,p,m,v,h,b,g,w=!!(8&r),y=!!(3&r),k=t.length,x=n.items,E=n.first,_=E,O=null,C=[],U=[];if(w)for(g=0;g<k;g+=1)h=a(v=t[g],g),void 0!==(b=x.get(h))&&(null==(u=b.a)||u.measure(),(m??(m=new Set)).add(b));for(g=0;g<k;g+=1)if(h=a(v=t[g],g),void 0!==(b=x.get(h))){if(y&&Un(b,v,g,r),0!==(b.e.f&B)&&(Et(b.e),w&&(null==(c=b.a)||c.unfix(),(m??(m=new Set)).delete(b))),b!==_){if(void 0!==p&&p.has(b)){if(C.length<U.length){var M,L=U[0];O=L.prev;var z=C[0],Q=C[C.length-1];for(M=0;M<C.length;M+=1)Ln(C[M],L,i);for(M=0;M<U.length;M+=1)p.delete(U[M]);zn(n,z.prev,Q.next),zn(n,O,z),zn(n,Q,L),_=L,O=Q,g-=1,C=[],U=[]}else p.delete(b),Ln(b,_,i),zn(n,b.prev,b.next),zn(n,b,null===O?n.first:O.next),zn(n,O,b),O=b;continue}for(C=[],U=[];null!==_&&_.k!==h;)0===(_.e.f&B)&&(p??(p=new Set)).add(_),U.push(_),_=_.next;if(null===_)continue;b=_}C.push(b),O=b,_=b.next}else{var $=o.get(h);if(void 0!==$){o.delete(h),x.set(h,$);var A=O?O.next:_;zn(n,O,$),zn(n,$,A),Ln($,A,i),O=$}else{O=Mn(_?_.e.nodes_start:i,n,O,null===O?n.first:O.next,v,h,g,s,r,l)}x.set(h,O),C=[],U=[],_=O.next}if(null!==_||void 0!==p){for(var I=void 0===p?[]:S(p);null!==_;)0===(_.e.f&B)&&I.push(_),_=_.next;var T=I.length;if(T>0){var N=4&r&&0===k?i:null;if(w){for(g=0;g<T;g+=1)null==(d=I[g].a)||d.measure();for(g=0;g<T;g+=1)null==(f=I[g].a)||f.fix()}!function(e,t,n){for(var o=e.items,i=[],s=t.length,r=0;r<s;r++)xt(t[r].e,i,!0);var a=s>0&&0===i.length&&null!==n;if(a){var l=n.parentNode;l.textContent="",l.append(n),o.clear(),zn(e,t[0].prev,t[s-1].next)}kt(i,()=>{for(var n=0;n<s;n++){var i=t[n];a||(o.delete(i.k),zn(e,i.prev,i.next)),gt(i.e,!a)}})}(n,I,N)}}w&&we(()=>{var e;if(void 0!==m)for(b of m)null==(e=b.a)||e.apply()});for(var D of(e.first=n.first&&n.first.e,e.last=O&&O.e,o.values()))gt(D.e);o.clear()}(u,l,a,f,r,i,t,o,n),null!==s&&(0===l.length?c?Et(c):c=vt(()=>s(r)):null!==c&&yt(c,()=>{c=null}))}mt(()=>{u??(u=Qt);var e=(l=Xt(p)).length;d&&0===e||(d=0===e,m(),Xt(p))})}function Un(e,t,n,o){1&o&&Ke(e.v,t),2&o?Ke(e.i,n):e.i=n}function Mn(e,t,n,o,i,s,r,a,l,u,c){var d=!!(1&l)?!(16&l)?We(i,!1,!1):Ve(i):i,f=2&l?Ve(r):r,p={i:f,v:d,k:s,a:null,e:null,prev:n,next:o};try{if(null===e)document.createDocumentFragment().append(e=nt());return p.e=vt(()=>a(e,d,f,u),false),p.e.prev=n&&n.e,p.e.next=o&&o.e,null===n?c||(t.first=p):(n.next=p,n.e.next=p.e),null!==o&&(o.prev=p,o.e.prev=p.e),p}finally{}}function Ln(e,t,n){for(var o=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,s=e.e.nodes_start;null!==s&&s!==o;){var r=it(s);i.before(s),s=r}}function zn(e,t,n){null===t?e.first=n:(t.next=n,t.e.next=n&&n.e),null!==n&&(n.prev=t,n.e.prev=t&&t.e)}function Qn(e,t,n){var o,i,s=e,r=null,a=null;function l(){i&&(yt(i),i=null),r&&(r.lastChild.remove(),s.before(r),r=null),i=a,a=null}mt(()=>{if(o!==(o=t())){var e=!1;if(o){var i=s;e,a=vt(()=>n(i,o))}l()}},W)}function $n(e,t,n){ut(4,()=>{var o=Zt(()=>t(e,null==n?void 0:n())||{});if(n&&(null==o?void 0:o.update)){var i=!1,s={};ft(()=>{var e=n();nn(e),i&&re(s,e)&&(s=e,o.update(e))}),i=!0}if(null==o?void 0:o.destroy)return()=>o.destroy()},!1)}const An=[..." \t\n\r\f \v\ufeff"];function In(e,t,n,o,i,s){var r=e.__className;if(r!==n||void 0===r){var a=function(e,t,n){var o=null==e?"":""+e;if(t&&(o=o?o+" "+t:t),n)for(var i in n)if(n[i])o=o?o+" "+i:i;else if(o.length)for(var s=i.length,r=0;(r=o.indexOf(i,r))>=0;){var a=r+s;0!==r&&!An.includes(o[r-1])||a!==o.length&&!An.includes(o[a])?r=a:o=(0===r?"":o.substring(0,r))+o.substring(a+1)}return""===o?null:o}(n,o,s);null==a?e.removeAttribute("class"):e.className=a,e.__className=n}else if(s&&i!==s)for(var l in s){var u=!!s[l];null!=i&&u===!!i[l]||e.classList.toggle(l,u)}return s}function Tn(e,t,n,o){if(e.__style!==t){var i=function(e){return null==e?null:String(e)}(t);null==i?e.removeAttribute("style"):e.style.cssText=i,e.__style=t}return o}const Nn=Symbol("is custom element"),Dn=Symbol("is html");function qn(e,t,n,o){var i=function(e){return e.__attributes??(e.__attributes={[Nn]:e.nodeName.includes("-"),[Dn]:e.namespaceURI===ie})}(e);i[t]!==(i[t]=n)&&("loading"===t&&(e[ee]=n),null==n?e.removeAttribute(t):"string"!=typeof n&&function(e){var t,n=jn.get(e.nodeName);if(n)return n;jn.set(e.nodeName,n=[]);var o=e,i=Element.prototype;for(;i!==o;){for(var s in t=U(o))t[s].set&&n.push(s);o=z(o)}return n}(e).includes(t)?e[t]=n:e.setAttribute(t,n))}var jn=new Map;function Pn(e){var t=e.type;return"number"===t||"range"===t}function Fn(e){return""===e?null:+e}function Bn(e=!1){const t=ue,n=t.l.u;if(!n)return;let o=()=>nn(t.s);if(e){let e=0,n={};const i=ke(()=>{let o=!1;const i=t.s;for(const e in i)i[e]!==n[e]&&(n[e]=i[e],o=!0);return o&&e++,e});o=()=>Xt(i)}var i;n.b.length&&(i=()=>{Vn(t,o),I(n.b)},lt(),ut(1048584,i,!0)),ct(()=>{const e=Zt(()=>n.m.map(A));return()=>{for(const t of e)"function"==typeof t&&t()}}),n.a.length&&ct(()=>{Vn(t,o),I(n.a)})}function Vn(e,t){if(e.l.s)for(const t of e.l.s)Xt(t);t()}function Rn(e){var t,n;null===ue&&ne(),le&&null!==ue.l?(t=ue,n=t.l,n.u??(n.u={a:[],b:[],m:[]})).m.push(e):ct(()=>{const t=Zt(e);if("function"==typeof t)return t})}function Wn(e){null===ue&&ne(),Rn(()=>()=>Zt(e))}"undefined"!=typeof window&&((p=window.__svelte??(window.__svelte={})).v??(p.v=new Set)).add("5");const Jn="Dub+";function Kn(){return(new Date).toLocaleTimeString()}function Hn(...e){console.log(`[${Kn()}] ${Jn}:`,...e)}function Yn(...e){console.error(`[${Kn()}] ${Jn}:`,...e)}function Xn(e,t=window){const n=e.split(".");let o=t;for(let e=0;e<n.length;e++){if(void 0===o[n[e]])return!1;o=o[n[e]]}return!0}function Gn(e,t={}){const n=Object.assign({},{interval:500,seconds:10},t);return new Promise((t,o)=>{let i=0;const s=1e3*n.seconds/n.interval,r=()=>{i++,e()?t():i<s?window.setTimeout(r,n.interval):o()};r()})}le=!0;var Zn=wn('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0" y="0" viewBox="0 0 2078.496 2083.914" enable-background="new 0 0 2078.496 2083.914" xml:space="preserve"><rect x="769.659" y="772.445" fill-rule="evenodd" clip-rule="evenodd" fill="#660078" width="539.178" height="539.178"></rect><g><rect x="1308.837" y="772.445" fill-rule="evenodd" clip-rule="evenodd" fill="#EB008B" width="537.488" height="539.178"></rect><polygon fill="#EB008B" points="2045.015,1042.035 1845.324,1311.625 1845.324,772.446 \t"></polygon></g><g><rect x="232.172" y="772.445" fill-rule="evenodd" clip-rule="evenodd" fill="#EB008B" width="537.487" height="539.178"></rect><polygon fill="#EB008B" points="33.481,1042.034 233.172,772.445 233.172,1311.623 \t"></polygon></g><g><rect x="769.659" y="1311.624" fill-rule="evenodd" clip-rule="evenodd" fill="#6FCBDC" width="539.178" height="537.487"></rect><polygon fill="#6FCBDC" points="1039.248,2047.802 769.659,1848.111 1308.837,1848.111 \t"></polygon></g><g><rect x="769.659" y="234.958" fill-rule="evenodd" clip-rule="evenodd" fill="#6FCBDC" width="539.178" height="537.487"></rect><polygon fill="#6FCBDC" points="1039.249,35.268 1308.837,235.958 769.659,235.958 \t"></polygon></g></svg>');function eo(e){xn(e,Zn())}const to={en:{"Modal.confirm":"OK","Modal.cancel":"Cancel","Modal.close":"Close","Modal.defaultValue":"Default Value","Error.modal.title":"Dub+ Error","Error.modal.loggedout":"You're not logged in. Please login to use Dub+.","Error.unknown":"Something went wrong starting Dub+. Please refresh and try again.","Loading.text":"Waiting for QueUp...","Eta.tooltip.notInQueue":"You're not in the queue","Eta.tootltip":"ETA: {{minutes}} minutes","Snooze.tooltip":"Mute for current song","Snooze.tooltip.undo":"Cancel mute for current song","SnoozeVideo.tooltip":"Hide video for current song","SnoozeVideo.tooltip.undo":"Cancel hiding video for current song","Notifcation.permission.title":"Desktop Notification","Notification.permission.denied":"You have dismissed, or chosen to deny, the request to allow desktop notifications. If you change your mind, you will need to reset this in your browser's site settings.","Notification.permission.notSupported":"Sorry this browser does not support desktop notifications.  Please update your browser to the lastest version","Menu.title":"Dub+ Options","general.title":"General","user-interface.title":"User Interface","settings.title":"Settings","customize.title":"Customize","contact.title":"Contact","contact.bugs":"Report bugs on Discord","Switch.on":"On","Switch.off":"Off","MenuItem.edit":"Edit","autovote.label":"Autovote","autovote.description":"Toggles auto upvoting for every song","afk.label":"AFK Auto-respond","afk.description":"Toggle Away from Keyboard and customize AFK message.","afk.modal.title":"Custom AFK Message","afk.modal.content":"Enter a custom \"Away From Keyboard\" [AFK] message here. Message will be prefixed with '[AFK]'","afk.modal.placeholder":"Be right back!","auto-afk.label":"Auto AFK","auto-afk.description":"Automatically set yourself to AFK after a certain amount of time of inactivity","auto-afk.modal.title":"Auto AFK Timer","auto-afk.modal.content":"Enter the amount of time, in minutes, before you are set to AFK.","auto-afk.modal.validation":"Please enter a whole number greater than 0","emotes.label":"Emotes","emotes.description":"Adds Twitch, Bttv, and FrankerFacez emotes in chat.","autocomplete.label":"Autocomplete Emoji","autocomplete.description":"Toggle autocompleting emojis and emotes. Shows a preview box in the chat","autocomplete.preview.a11y":"press up and down to navigate, press enter or tab to select, press esc to close","autocomplete.preview.navigate":"navigate","autocomplete.preview.select":"select","autocomplete.preview.close":"close","custom-mentions.label":"Custom Mentions","custom-mentions.description":"Toggle using custom mentions to trigger sounds in chat","custom-mentions.modal.title":"Custom Mentions","custom-mentions.modal.content":"Add your custom mention triggers here (separate by comma)","custom-mentions.modal.placeholder":"separate, custom mentions, by, comma, :heart:","chat-cleaner.label":"Chat Cleaner","chat-cleaner.description":"Help keep CPU stress down by setting a limit of how many chat messages to keep in the chat box, deleting older messages.","chat-cleaner.modal.title":"Chat Cleaner","chat-cleaner.modal.content":"Please specify the number of most recent chat items that will remain in your chat history","chat-cleaner.modal.validation":"Please enter a whole number greater than, or equal to, 1","chat-cleaner.modal.placeholder":"500","collapsible-images.label":"Collapsible Images","collapsible-images.description":"Make images in the chat collapsible","mention-notifications.label":"Notification on Mentions","mention-notifications.description":"Enable desktop notifications when a user mentions you in chat","pm-notifications.label":"Notification on PM","pm-notifications.description":"Enable desktop notifications when a user receives a private message","pm-notifications.notification.title":"You have a new PM","dj-notification.label":"DJ Notification","dj-notification.description":"Get a notification when you are coming up to be the DJ","dj-notification.modal.title":"DJ Notification","dj-notification.modal.content":'Please specify the position in queue you want to be notified at. Use "0" to be notified when you start playing.',"dj-notification.notification.title":"DJ Alert!","dj-notification.notification.content":"You will be DJing shortly! Make sure your song is set!","dj-notification.modal.validation":"Please enter a whole number greater than, or equal to, 0","dubs-hover.label":"Show Dubs on Hover","dubs-hover.description":"Show who dubs a song when hovering over the dubs count","dubs-hover.no-votes":"No {{dubType}}s have been casted yet!","dubs-hover.no-grabs":"No one has grabbed this song yet!","downdubs-in-chat.label":"Downdubs in Chat (mods only)","downdubs-in-chat.description":"Toggle showing downdubs in the chat box (mods only)","downdubs-in-chat.chat-message":"@{{username}} has downdubbed your song {{song_name}}","updubs-in-chat.label":"Updubs in Chat","updubs-in-chat.description":"Toggle showing updubs in the chat box","updubs-in-chat.chat-message":"@{{username}} has updubbed your song {{song_name}}","grabs-in-chat.label":"Grabs in Chat","grabs-in-chat.description":"Toggle showing grabs in the chat box","grabs-in-chat.chat-message":"@{{username}} has grabbed your song {{song_name}}","snow.label":"Snow","snow.description":"Make it snow!","rain.label":"Rain","rain.description":"Make it rain!","fullscreen.label":"Fullscreen","fullscreen.description":"Toggle fullscreen video mode","split-chat.label":"Split Chat","split-chat.description":"Toggle Split Chat UI enhancement","hide-chat.label":"Hide Chat","hide-chat.description":"Toggles hiding the chat box","hide-video.label":"Hide Video","hide-video.description":"Toggles hiding the video box","hide-avatars.label":"Hide Avatars","hide-avatars.description":"Toggle hiding user avatars in the chat box","hide-bg.label":"Hide Background","hide-bg.description":"Toggle hiding background image","show-timestamps.label":"Show Timestamps","show-timestamps.description":"Toggle always showing chat message timestamps","flip-interface.label":"Flip Interface","flip-interface.description":"Swap the video and chat positions","pin-menu.label":"Pin Menu","pin-menu.description":"Pin the Dub+ menu to the left or right side. Use the action button to toggle which side it is pinned to. Only works in the non-mobile view","pin-menu.secondaryAction.description":"Click to toggle between pinning to the left or right side","spacebar-mute.label":"Spacebar Mute","spacebar-mute.description":"Turn on/off the ability to mute current song with the spacebar","warn-redirect.label":"Warn on Navigation","warn-redirect.description":"Warns you when accidentally clicking on a link that takes you out of QueUp","community-theme.label":"Community Theme","community-theme.description":"Toggle Community CSS theme","custom-css.label":"Custom CSS","custom-css.description":"Add your own custom CSS.","custom-css.modal.title":"Custom CSS","custom-css.modal.content":"Enter a url location for your custom css","custom-css.modal.placeholder":"https://example.com/example.css","custom-css.modal.validation":"Invalid URL","custom-bg.label":"Custom Background","custom-bg.description":"Add your own custom background.","custom-bg.modal.title":"Custom Background Image","custom-bg.modal.content":"Enter the full URL of an image. We recommend using a .jpg file. Leave blank to remove the current background image","custom-bg.modal.placeholder":"https://example.com/big-image.jpg","custom-notification-sound.label":"Custom Notification Sound","custom-notification-sound.description":"Change the notification sound to a custom one.","custom-notification-sound.modal.title":"Custom Notification Sound","custom-notification-sound.modal.content":"Enter the full URL of a sound file. We recommend using an .mp3 file. Leave blank to go back to QueUp's default sound","custom-notification-sound.modal.placeholder":"https://example.com/sweet-sound.mp3","custom-notification-sound.modal.validation":"Can't play sound from this URL. Please enter a valid URL to an MP3 file.","grab-response.label":"Grab Response","grab-response.description":"Sends a chat message when you grab a song","grab-response.modal.title":"Grab Response","grab-response.modal.content":"Enter a message to send when you grab a song","grab-response.modal.placeholder":"Thanks for the song!"}},no=Xe({current:"en"});function oo(e,t={}){return function(e,t,n){let o=to[e][t];return o||"en"===e||(o=to.en[t]),o?(Object.keys(n).forEach(e=>{const t=new RegExp(`{{${e}}}`,"g");o=o.replace(t,n[e])}),o):(Yn(`No translation found for ${e}.${t}`),t)}(no.current,e,t)}var io=bn('<div class="dubplus-waiting svelte-d2q0b"><div style="width: 26px; margin-right:5px"><!></div> <span style="flex: 1;"> </span></div>');const so=Xe({id:"",open:!1,title:"Dub+",content:"",value:"",placeholder:"",defaultValue:"",maxlength:999,validation:()=>!0,onConfirm:()=>!0,onCancel:()=>{}});function ro(e){so.open=e.open??!1,so.title=e.title||"Dub+",so.content=e.content||"",so.value=e.value||"",so.placeholder=e.placeholder||"",so.defaultValue=e.defaultValue,so.maxlength=e.maxlength||999,so.onConfirm=e.onConfirm,so.onCancel=e.onCancel,so.validation=e.validation||(()=>!0)}var ao=bn('<div class="default svelte-13gllby"><span class="default-label svelte-13gllby"> </span> <span class="default-value svelte-13gllby"> </span></div>'),lo=bn('<textarea class="svelte-13gllby">\n      </textarea>'),uo=bn('<p class="dp-modal--error svelte-13gllby"> </p>'),co=bn('<button class="dp-modal--cancel cancel svelte-13gllby"> </button> <button class="dp-modal--confirm confirm svelte-13gllby"> </button>',1),fo=bn('<button class="dp-modal--cancel cancel svelte-13gllby"> </button>'),po=bn('<dialog id="dubplus-dialog" class="dp-modal svelte-13gllby"><h1 class="svelte-13gllby"> </h1> <div class="dp-modal--content content svelte-13gllby"><p class="svelte-13gllby"> </p> <!> <!> <!></div> <div class="dp-modal--buttons buttons svelte-13gllby"><!></div></dialog>');function mo(e,t){de(t,!0);let n,o=Re("");Rn(()=>{n=document.getElementById("dubplus-dialog"),n.addEventListener("close",()=>{so.open=!1})}),ct(()=>{so.open&&n&&!n.open&&n.showModal()});var i=po(),s=st(i),r=st(s),a=at(s,2),l=st(a),u=st(l),c=at(l,2),d=e=>{var t=ao(),n=st(t),o=st(n),i=st(at(n,2));pt(e=>{En(o,`${e??""}:`),En(i,so.defaultValue)},[()=>oo("Modal.defaultValue")]),xn(e,t)};On(c,e=>{so.defaultValue&&e(d)});var f=at(c,2),p=e=>{var t=lo();pt(()=>{qn(t,"placeholder",so.placeholder),qn(t,"maxlength",so.maxlength<999?so.maxlength:999)}),function(e,t,n=t){var o=pe(),i=new WeakSet;un(e,"input",s=>{var r=s?e.defaultValue:e.value;if(r=Pn(e)?Fn(r):r,n(r),null!==ze&&i.add(ze),o&&r!==(r=t())){var a=e.selectionStart,l=e.selectionEnd;e.value=r??"",null!==l&&(e.selectionStart=a,e.selectionEnd=Math.min(l,e.value.length))}}),null==Zt(t)&&e.value&&(n(Pn(e)?Fn(e.value):e.value),null!==ze&&i.add(ze)),ft(()=>{var n=t();e===document.activeElement&&i.has(ze)||Pn(e)&&n===Fn(e.value)||("date"!==e.type||n||e.value)&&n!==e.value&&(e.value=n??"")})}(t,()=>so.value,e=>so.value=e),xn(e,t)};On(f,e=>{(so.placeholder||so.value)&&e(p)});var m=at(f,2),v=e=>{var t=uo(),n=st(t);pt(()=>En(n,Xt(o))),xn(e,t)};On(m,e=>{Xt(o)&&e(v)});var h=st(at(a,2)),b=e=>{var t=co(),i=rt(t);i.__click=()=>{n.close(),so.open=!1,Je(o,""),"function"==typeof so.onCancel&&so.onCancel()};var s=st(i),r=at(i,2);r.__click=()=>{const e=so.validation(so.value);!0===e?(n.close(),so.open=!1,so.onConfirm(so.value),Je(o,"")):Je(o,e,!0)};var a=st(r);pt((e,t)=>{En(s,e),En(a,t)},[()=>oo("Modal.cancel"),()=>oo("Modal.confirm")]),xn(e,t)},g=e=>{var t=fo();t.__click=()=>{n.close(),so.open=!1,Je(o,"")};var i=st(t);pt(e=>En(i,e),[()=>oo("Modal.close")]),xn(e,t)};On(h,e=>{"function"==typeof so.onConfirm?e(b):e(g,!1)}),pt(()=>{En(r,so.title),En(u,so.content)}),xn(e,i),fe()}pn(["click"]);const vo=(e,{to:t,position:n="append"})=>{ct(()=>{var o;e.id&&(null==(o=document.getElementById(e.id))||o.remove());const i=document.querySelector(t);if(!i)throw new Error(`teleport container not found: ${t}`);return"append"===n?i.appendChild(e):i.prepend(e),()=>{e.remove()}})};function ho(){return document.querySelector("#chat-txt-message")}function bo(){return document.querySelector("ul.chat-main")}function go(e=""){return document.querySelectorAll(`ul.chat-main > li${e}`)}function wo(){return document.querySelectorAll(".chat-main > li .autolink-image")}function yo(){return document.querySelector(".backstretch img")}function ko(){return document.querySelector(".queue-position")}const xo=".player_sharing";var Eo=()=>{document.querySelector(".dubplus-menu").classList.toggle("dubplus-menu-open")},_o=bn('<button id="dubplus-menu-icon" type="button" aria-label="Dub+ menu" class="dubplus-icon svelte-tqf6wa"><!></button>');pn(["click"]);const So={"dubplus-autovote":"autovote","dubplus-afk":"afk","dubplus-emotes":"emotes","dubplus-autocomplete":"autocomplete",custom_mentions:"custom-mentions","chat-cleaner":"chat-cleaner",mention_notifications:"mention-notifications",dubplus_pm_notifications:"pm-notifications",dj_notification:"dj-notification","dubplus-dubs-hover":"dubs-hover","dubplus-downdubs":"downdubs-in-chat","dubplus-updubs":"updubs-in-chat","dubplus-grabschat":"grabs-in-chat","dubplus-snow":"snow","dubplus-rain":"rain","dubplus-fullscreen":"fullscreen","dubplus-split-chat":"split-chat","dubplus-video-only":"hide-chat","dubplus-chat-only":"hide-video","dubplus-hide-avatars":"hide-avatars","dubplus-hide-bg":"hide-bg","dubplus-show-timestamp":"show-timestamps","dubplus-spacebar-mute":"spacebar-mute",warn_redirect:"warn-redirect","dubplus-comm-theme":"community-theme","dubplus-custom-css":"custom-css","dubplus-custom-bg":"custom-bg","dubplus-custom-notification-sound":"custom-notification-sound"},Oo={customAfkMessage:So["dubplus-afk"],custom_mentions:So.custom_mentions,chat_cleaner:So["chat-cleaner"],dj_notification:So.dj_notification,css:So["dubplus-custom-css"],bg:So["dubplus-custom-bg"],notificationSound:So["dubplus-custom-notification-sound"],"dubplus-custom-notification-sound":So["dubplus-custom-notification-sound"]};const Co="dubplusUserSettingsV2";let Uo=Xe(Object.assign({},{options:{},menu:{general:"open","user-interface":"open",settings:"open",customize:"open",contact:"open"},custom:{}},function(){try{const e=JSON.parse(localStorage.getItem(Co));if(e)return e}catch(e){Hn("Error loading v2 settings, trying old settings. Error:",e)}try{const e=JSON.parse(localStorage.getItem("dubplusUserSettings"));if(e)return function(e){Hn("Old Settings",e);const t={options:{},menu:{...e.menu},custom:{}};for(const[n,o]of Object.entries(e.options)){const e=So[n];try{t.options[e]=o}catch(t){Yn("Error converting options",t.message,n,e,o)}}for(const[n,o]of Object.entries(e.custom)){const e=Oo[n];try{t.custom[e]=o}catch(t){Yn("Error converting custom",t.message,n,e,o)}}return t}(e)}catch(e){Hn("Error loading old settings:",e)}return{}}()));function Mo(){try{localStorage.setItem(Co,JSON.stringify(Uo))}catch(e){Yn("Error saving user settings:",e)}}function Lo(e,t,n){if("option"===e)return Uo.options[t]=n,void Mo();if("custom"===e)return Uo.custom[t]=n,void Mo();if("menu"===e)return Uo.menu[t]=n,void Mo();throw new Error(`Invalid section: "${e}"`)}var zo=bn('<button type="button" class="dubplus-menu-section-header svelte-1fur3ft"><span></span> <p class="svelte-1fur3ft"> </p></button>');function Qo(e,t){de(t,!0);let n=Re("down"),o=Re(!0);ct(()=>{"closed"===Uo.menu[t.settingsId]?(Je(n,"right"),Je(o,!1)):(Je(n,"down"),Je(o,!0))});var i=zo();i.__click=function(){Uo.menu[t.settingsId]="closed"===Uo.menu[t.settingsId]?"open":"closed",Lo("menu",t.settingsId,Uo.menu[t.settingsId])};var s=st(i),r=st(at(s,2));pt(()=>{qn(i,"id",`dubplus-menu-section-header-${t.settingsId}`),qn(i,"aria-expanded",Xt(o)),qn(i,"aria-controls",`dubplus-menu-section-${t.settingsId}`),In(s,0,`fa fa-angle-${Xt(n)??""}`,"svelte-1fur3ft"),En(r,t.name)}),xn(e,i),fe()}pn(["click"]);var $o=bn('<ul class="dubplus-menu-section svelte-zemo66" role="region"><!></ul>');function Ao(e,t){var n=$o();!function(e,t,...n){var o,i=e,s=$;mt(()=>{s!==(s=t())&&(o&&(gt(o),o=null),o=vt(()=>s(i,...n)))},W)}(st(n),()=>t.children),pt(()=>{qn(n,"id",`dubplus-menu-section-${t.settingsId}`),qn(n,"aria-labelledby",`dubplus-menu-section-header-${t.settingsId}`)}),xn(e,n)}var Io=bn('<li class="dubplus-menu-icon svelte-xz8po2"><!> <a class="dubplus-menu-label svelte-xz8po2" target="_blank"> </a></li>');function To(e,t){var n=Io(),o=st(n);Qn(o,()=>t.icon,(e,t)=>{t(e,{})});var i=at(o,2),s=st(i);pt(()=>{qn(i,"href",t.href),En(s,t.text)}),xn(e,n)}var No=wn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 0c53 0 96 43 96 96l0 3.6c0 15.7-12.7 28.4-28.4 28.4l-135.1 0c-15.7 0-28.4-12.7-28.4-28.4l0-3.6c0-53 43-96 96-96zM41.4 105.4c12.5-12.5 32.8-12.5 45.3 0l64 64c.7 .7 1.3 1.4 1.9 2.1c14.2-7.3 30.4-11.4 47.5-11.4l112 0c17.1 0 33.2 4.1 47.5 11.4c.6-.7 1.2-1.4 1.9-2.1l64-64c12.5-12.5 32.8-12.5 45.3 0s12.5 32.8 0 45.3l-64 64c-.7 .7-1.4 1.3-2.1 1.9c6.2 12 10.1 25.3 11.1 39.5l64.3 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c0 24.6-5.5 47.8-15.4 68.6c2.2 1.3 4.2 2.9 6 4.8l64 64c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0l-63.1-63.1c-24.5 21.8-55.8 36.2-90.3 39.6L272 240c0-8.8-7.2-16-16-16s-16 7.2-16 16l0 239.2c-34.5-3.4-65.8-17.8-90.3-39.6L86.6 502.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l64-64c1.9-1.9 3.9-3.4 6-4.8C101.5 367.8 96 344.6 96 320l-64 0c-17.7 0-32-14.3-32-32s14.3-32 32-32l64.3 0c1.1-14.1 5-27.5 11.1-39.5c-.7-.6-1.4-1.2-2.1-1.9l-64-64c-12.5-12.5-12.5-32.8 0-45.3z"></path></svg>');function Do(e){xn(e,No())}var qo=wn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M64 32l320 0c35.3 0 64 28.7 64 64l0 320c0 35.3-28.7 64-64 64L64 480c-35.3 0-64-28.7-64-64L0 96C0 60.7 28.7 32 64 32zM305.9 166.4c20.6 0 37.3-16.7 37.3-37.3s-16.7-37.3-37.3-37.3c-18 0-33.1 12.8-36.6 29.8c-30.2 3.2-53.8 28.8-53.8 59.9l0 .2c-32.8 1.4-62.8 10.7-86.6 25.5c-8.8-6.8-19.9-10.9-32-10.9c-28.9 0-52.3 23.4-52.3 52.3c0 21 12.3 39 30.1 47.4c1.7 60.7 67.9 109.6 149.3 109.6s147.6-48.9 149.3-109.7c17.7-8.4 29.9-26.4 29.9-47.3c0-28.9-23.4-52.3-52.3-52.3c-12 0-23 4-31.9 10.8c-24-14.9-54.3-24.2-87.5-25.4l0-.1c0-22.2 16.5-40.7 37.9-43.7l0 0c3.9 16.5 18.7 28.7 36.3 28.7zM155 248.1c14.6 0 25.8 15.4 25 34.4s-11.8 25.9-26.5 25.9s-27.5-7.7-26.6-26.7s13.5-33.5 28.1-33.5zm166.4 33.5c.9 19-12 26.7-26.6 26.7s-25.6-6.9-26.5-25.9c-.9-19 10.3-34.4 25-34.4s27.3 14.6 28.1 33.5zm-42.1 49.6c-9 21.5-30.3 36.7-55.1 36.7s-46.1-15.1-55.1-36.7c-1.1-2.6 .7-5.4 3.4-5.7c16.1-1.6 33.5-2.5 51.7-2.5s35.6 .9 51.7 2.5c2.7 .3 4.5 3.1 3.4 5.7z"></path></svg>');function jo(e){xn(e,qo())}var Po=wn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64h98.2V334.2H109.4V256h52.8V222.3c0-87.1 39.4-127.5 125-127.5c16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1c-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H255V480H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64z"></path></svg>');function Fo(e){xn(e,Po())}var Bo=wn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM351.3 199.3v0c0 86.7-66 186.6-186.6 186.6c-37.2 0-71.7-10.8-100.7-29.4c5.3 .6 10.4 .8 15.8 .8c30.7 0 58.9-10.4 81.4-28c-28.8-.6-53-19.5-61.3-45.5c10.1 1.5 19.2 1.5 29.6-1.2c-30-6.1-52.5-32.5-52.5-64.4v-.8c8.7 4.9 18.9 7.9 29.6 8.3c-9-6-16.4-14.1-21.5-23.6s-7.8-20.2-7.7-31c0-12.2 3.2-23.4 8.9-33.1c32.3 39.8 80.8 65.8 135.2 68.6c-9.3-44.5 24-80.6 64-80.6c18.9 0 35.9 7.9 47.9 20.7c14.8-2.8 29-8.3 41.6-15.8c-4.9 15.2-15.2 28-28.8 36.1c13.2-1.4 26-5.1 37.8-10.2c-8.9 13.1-20.1 24.7-32.9 34c.2 2.8 .2 5.7 .2 8.5z"></path></svg>');function Vo(e){xn(e,Bo())}var Ro=bn("<!> <!> <!> <!>",1),Wo=bn("<!> <!>",1);function Jo(e,t,n){t.disabled||"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),n())}function Ko(e,t,n){t.disabled||n()}var Ho=bn('<div role="switch" tabindex="0" class="svelte-3uqoxb"><span class="dubplus-switch svelte-3uqoxb"><span class="svelte-3uqoxb"></span></span> <span class="dubplus-switch-label svelte-3uqoxb"> </span></div>');pn(["click","keydown"]);var Yo=wn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1 0 32c0 8.8 7.2 16 16 16l32 0zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"></path></svg>');function Xo(e){xn(e,Yo())}function Go(e){return window.QueUp.helpers.isSiteAdmin(e)||window.QueUp.room.users.getIfOwner(e)||window.QueUp.room.users.getIfManager(e)||window.QueUp.room.users.getIfMod(e)}var Zo=bn('<button type="button" class="svelte-xhis6z"><!> <span class="sr-only"> </span></button>'),ei=bn('<button type="button" class="svelte-xhis6z"><!> <span class="sr-only"> </span></button>'),ti=bn("<li><!> <!> <!></li>");function ni(e,t){var n;de(t,!0);const o=(null==(n=t.secondaryAction)?void 0:n.icon)||Xo;function i(){ro({title:oo(t.customize.title),content:oo(t.customize.content),placeholder:oo(t.customize.placeholder),defaultValue:t.customize.defaultValue?oo(t.customize.defaultValue):"",maxlength:t.customize.maxlength,value:Uo.custom[t.id]||"",validation:t.customize.validation,onConfirm:e=>{Lo("custom",t.id,e),""!==e.trim()||t.customize.defaultValue||(Lo("option",t.id,!1),t.turnOff()),"function"==typeof t.customize.onConfirm&&t.customize.onConfirm(e)},onCancel:()=>{t.customize.defaultValue||void 0!==Uo.custom[t.id]&&""!==Uo.custom[t.id]||(Lo("option",t.id,!1),t.turnOff()),"function"==typeof t.customize.onCancel&&t.customize.onCancel()}}),so.open=!0}Rn(()=>{if(t.init&&t.init(),Uo.options[t.id]){(!t.modOnly||Go(window.QueUp.session.id))&&t.turnOn(!0)}}),Wn(()=>{Uo.options[t.id]&&t.turnOff()});var s=ti();let r;var a=st(s);{let e=Ee(()=>!!t.modOnly&&!Go(window.QueUp.session.id)),n=Ee(()=>oo(t.label));!function(e,t){function n(){Uo.options[t.optionId]=!Uo.options[t.optionId],t.onToggle(Uo.options[t.optionId])}de(t,!0);var o=Ho();o.__click=[Ko,t,n],o.__keydown=[Jo,t,n];var i=at(st(o),2),s=st(i);pt(()=>{qn(o,"aria-disabled",t.disabled?"true":"false"),qn(o,"aria-checked",Uo.options[t.optionId]?"true":"false"),En(s,t.label)}),xn(e,o),fe()}(a,{get disabled(){return Xt(e)},get label(){return Xt(n)},onToggle:e=>{!t.customize||!0!==e||Uo.custom[t.id]?(Lo("option",t.id,e),e?t.turnOn():t.turnOff()):i()},get optionId(){return t.id}})}var l=at(a,2),u=e=>{var t=Zo();t.__click=i;var n=st(t);Xo(n);var o=st(at(n,2));pt(e=>En(o,e),[()=>oo("MenuItem.edit")]),xn(e,t)};On(l,e=>{t.customize&&e(u)});var c=at(l,2),d=e=>{var n=ei();n.__click=function(...e){var n;null==(n=t.secondaryAction.onClick)||n.apply(this,e)};var i=st(n);o(i,{});var s=st(at(i,2));pt((e,t)=>{qn(n,"title",e),En(s,t)},[()=>oo(t.secondaryAction.description),()=>oo(t.secondaryAction.description)]),xn(e,n)};On(c,e=>{t.secondaryAction&&e(d)}),pt((e,n)=>{qn(s,"id",`dubplus-${t.id}`),qn(s,"title",e),r=In(s,0,"svelte-xhis6z",null,r,n)},[()=>oo(t.description),()=>({disabled:!!t.modOnly&&!Go(window.QueUp.session.id)})]),xn(e,s),fe()}pn(["click"]);const oi="realtime:room_playlist-dub",ii="realtime:room_playlist-queue-update-grabs",si="realtime:user-leave",ri="realtime:room_playlist-update",ai="realtime:chat-message",li="realtime:new-message";function ui(){var e,t,n;null==(n=null==(t=null==(e=window.QueUp)?void 0:e.playerController)?void 0:t.voteUp)||n.click()}const ci={id:"autovote",label:"autovote.label",description:"autovote.description",category:"general",turnOff(){window.QueUp.Events.unbind(ri,ui)},turnOn(){ui(),window.QueUp.Events.bind(ri,ui)}};function di(e,t){const n=document.createElement("li");n.className=`dubplus-chat-system ${e}`;const o=document.createElement("div");o.className="chatDelete",o.onclick=function(e){e.target.parentElement.remove()};const i=document.createElement("span");i.className="icon-close",o.appendChild(i),n.appendChild(o);const s=document.createElement("div");s.className="text",s.textContent=t,n.appendChild(s),bo().appendChild(n)}function fi(e){const t=ho(),n=t.value;t.value=e,window.QueUp.room.chat.sendMessage(),n&&(t.value=n)}let pi=!0;function mi(e){if(!pi)return;const t=e.message,n=window.QueUp.session.get("username");if(t.includes(`@${n}`)&&window.QueUp.session.id!==e.user.userInfo.userid){let e="";e=Uo.custom.afk?`[AFK] ${Uo.custom.afk}`:`[AFK] ${oo("afk.modal.placeholder")}`,fi(e),pi=!1,setTimeout(()=>{pi=!0},3e4)}}const vi={id:"afk",label:"afk.label",description:"afk.description",category:"general",turnOn(){window.QueUp.Events.bind(ai,mi)},turnOff(){window.QueUp.Events.unbind(ai,mi)},custom:{title:"afk.modal.title",content:"afk.modal.content",placeholder:"afk.modal.placeholder",defaultValue:"afk.modal.placeholder",maxlength:255}},hi="s";const bi=new class{constructor(){this.db=null;const e=window.indexedDB.open("d2",1),t=this;e.onsuccess=function(){t.db=this.result},e.onerror=function(e){console.error("Dub+","indexedDB request error:",e)},e.onupgradeneeded=function(){t.db=null,this.result.createObjectStore(hi,{keyPath:"k"}).transaction.oncomplete=function(){t.db=this.db}}}get(e){return new Promise(t=>{this.db?this.db.transaction(hi).objectStore(hi).get(e).onsuccess=function(){var e;t((null==(e=this.result)?void 0:e.v)||null)}:setTimeout(()=>{this.get(e).then(t)},100)})}set(e,t){this.db.transaction(hi,"readwrite").objectStore(hi).put({k:e,v:t})}};const gi={emoji:{template:e=>(e=e.replace(/:/g,""),`${window.emojify.defaultConfig.img_dir}/${encodeURI(e)}.png`)},twitchJSONSLoaded:!1,bttvJSONSLoaded:!1,frankerfacezJSONLoaded:!1,twitch:{template:e=>`//static-cdn.jtvnw.net/emoticons/v1/${e}/3.0`,emotesMap:new Map},bttv:{template:e=>`//cdn.betterttv.net/emote/${e}/3x`,emotesMap:new Map},frankerFacez:{template:e=>`//cdn.frankerfacez.com/emoticon/${e}/1`,emotesMap:new Map},shouldUpdateAPIs:e=>bi.get(`${e}_api`).then(t=>{if(t)try{if(void 0!==JSON.parse(t).error)return!0}catch{return!0}const n=Date.now(),o=parseInt(localStorage.getItem(`${e}_api_timestamp`));return isNaN(o)||n-o>432e6||!t}),loadTwitchEmotes(){return this.twitchJSONSLoaded?Promise.resolve():this.shouldUpdateAPIs("twitch").then(e=>e?(Hn("twitch","loading from api"),fetch("//cdn.jsdelivr.net/gh/Jiiks/BetterDiscordApp/data/emotedata_twitch_global.json").then(e=>e.json()).then(e=>{const t={};for(const n in e.emotes)t[n]||(t[n]=e.emotes[n].image_id);localStorage.setItem("twitch_api_timestamp",Date.now().toString()),bi.set("twitch_api",JSON.stringify(t)),gi.processTwitchEmotes(t)}).catch(e=>Yn(e))):bi.get("twitch_api").then(e=>{Hn("twitch","loading from IndexedDB");const t=JSON.parse(e);gi.processTwitchEmotes(t)}))},loadBTTVEmotes(){return this.bttvJSONSLoaded?Promise.resolve():this.shouldUpdateAPIs("bttv").then(e=>e?(Hn("bttv","loading from api"),fetch("//api.betterttv.net/3/cached/emotes/global").then(e=>e.json()).then(e=>{const t={};e.forEach(e=>{t[e.code]||(t[e.code]=e.id)}),localStorage.setItem("bttv_api_timestamp",Date.now().toString()),bi.set("bttv_api",JSON.stringify(t)),gi.processBTTVEmotes(t)}).catch(e=>Yn(e))):bi.get("bttv_api").then(e=>{Hn("bttv","loading from IndexedDB");const t=JSON.parse(e);gi.processBTTVEmotes(t)}))},loadFrankerFacez(){return this.frankerfacezJSONLoaded?Promise.resolve():this.shouldUpdateAPIs("frankerfacez").then(e=>e?(Hn("frankerfacez","loading from api"),fetch("//api.frankerfacez.com/v1/emoticons?per_page=200&private=off&sort=count-desc").then(e=>e.json()).then(e=>{const t=e;localStorage.setItem("frankerfacez_api_timestamp",Date.now().toString()),bi.set("frankerfacez_api",JSON.stringify(t)),gi.processFrankerFacez(t)}).catch(e=>Yn(e))):bi.get("frankerfacez_api").then(e=>{Hn("frankerfacez","loading from IndexedDB");const t=JSON.parse(e);gi.processFrankerFacez(t)}))},processTwitchEmotes(e){for(const t in e)if(Object.hasOwn(e,t)){const n=t.toLowerCase();window.emojify.emojiNames.includes(n)?this.twitch.emotesMap.set(`${n}_twitch`,e[t]):this.twitch.emotesMap.set(n,e[t])}this.twitchJSONSLoaded=!0},processBTTVEmotes(e){for(const t in e)if(Object.hasOwn(e,t)){const n=t.toLowerCase();if(t.includes(":"))continue;window.emojify.emojiNames.includes(n)||this.twitch.emotesMap.has(n)?this.bttv.emotesMap.set(`${n}_bttv`,e[t]):this.bttv.emotesMap.set(n,e[t])}this.bttvJSONSLoaded=!0},processFrankerFacez(e){for(const t of e.emoticons){const e=t.name,n=e.toLowerCase();e.includes(":")||(window.emojify.emojiNames.includes(n)||this.twitch.emotesMap.has(n)||this.bttv.emotesMap.has(n)?this.frankerFacez.emotesMap.set(`${n}_ffz`,t.id):this.frankerFacez.emotesMap.set(n,t.id))}this.frankerfacezJSONLoaded=!0},findMatchingEmotes(e,t=!1){const n=[];return window.emojify.emojiNames.forEach(t=>{t.includes(e)&&n.push({src:this.emoji.template(t),text:t,alt:t,platform:"emojify"})}),t?(Array.from(this.twitch.emotesMap.keys()).forEach(t=>{t.includes(e)&&n.push({src:this.twitch.template(this.twitch.emotesMap.get(t)),text:t,alt:t,platform:"twitch"})}),Array.from(this.bttv.emotesMap.keys()).forEach(t=>{t.includes(e)&&n.push({src:this.bttv.template(this.bttv.emotesMap.get(t)),text:t,alt:t,platform:"bttv"})}),Array.from(this.frankerFacez.emotesMap.keys()).forEach(t=>{t.includes(e)&&n.push({src:this.frankerFacez.template(this.frankerFacez.emotesMap.get(t)),text:t,alt:t,platform:"ffz"})}),n):n}};function wi(e,t,n,o,i){const s=document.createElement("img");return s.className=`emoji ${e}-emote`,s.title=n,s.alt=n,s.src=t,s}function yi(e){e.querySelectorAll(".text p").forEach(e=>{if(!e.hasAttribute("dubplus-emotes-processed")&&""!==(null==e?void 0:e.textContent.trim())){const t=function(e){const t=/(:[^: ]+:)/g,n=e.split(t),o=[];return n.forEach(e=>{if(e.match(t)){const t=e.toLowerCase().replace(/^:/,"").replace(/:$/,"");if(gi.twitchJSONSLoaded&&gi.twitch.emotesMap.has(t)){const e=gi.twitch.emotesMap.get(t),n=wi("twitch",gi.twitch.template(e),t);o.push(n)}else if(gi.bttvJSONSLoaded&&gi.bttv.emotesMap.has(t)){const e=gi.bttv.emotesMap.get(t),n=wi("bttv",gi.bttv.template(e),t);o.push(n)}else if(gi.frankerfacezJSONLoaded&&gi.frankerFacez.emotesMap.has(t)){const e=gi.frankerFacez.emotesMap.get(t),n=wi("frankerFacez",gi.frankerFacez.template(e),t);o.push(n)}else o.push(document.createTextNode(e))}else o.push(document.createTextNode(e))}),o}(e.textContent);e.replaceChildren(...t),e.setAttribute("dubplus-emotes-processed","true")}})}function ki(e){if(null==e?void 0:e.chatid){const t=document.querySelector(`.chat-id-${e.chatid}`);if(t)return void yi(t)}const t=go();(null==t?void 0:t.length)&&t.forEach(yi)}const xi={id:"emotes",label:"emotes.label",description:"emotes.description",category:"general",turnOn(){gi.loadTwitchEmotes().then(()=>gi.loadBTTVEmotes()).then(()=>gi.loadFrankerFacez()).then(()=>{ki(),window.QueUp.Events.bind(ai,ki)})},turnOff(){window.QueUp.Events.unbind(ai,ki)}},Ei=Xe({selectedIndex:0,emojiList:[]});function _i(){Ei.selectedIndex=0,Ei.emojiList=[]}function Si(e){return" "===e||"\n"===e}const Oi={up:"ArrowUp",down:"ArrowDown",enter:"Enter",esc:"Escape",tab:"Tab"};let Ci,Ui=document.querySelector("#autocomplete-preview");function Mi(e,t){const n=Ei.emojiList[t],[o,i]=function(e,t){let n=t>0?t:0;for(;n>0&&":"!==e[n];)n-=1;let o=t;for(;!Si(e[o])&&o<e.length;)o+=1;return[n,o]}(e.value,e.selectionStart),s=e.value.substring(o,i);e.value=e.value.replace(s,`:${n.text}:`),_i()}function Li(e){const t=e.target,n=t.value,o=t.selectionStart;let i="",s=o-1;for(;!Si(n[s])&&s>=0;)i=n[s]+i,s--;let r=o;for(;!Si(n[r])&&r<n.length;)i+=n[r],r++;if(i.startsWith(":")&&i.length>=2&&!i.endsWith(":")){const e=i.substring(1).trim();!function(e,t){const n=["emojify","twitch","bttv","ffz"];Ei.emojiList=e.filter((e,t,n)=>t===n.findIndex(t=>t.src===e.src&&t.platform===e.platform)).sort((e,o)=>{const i=n.indexOf(e.platform),s=n.indexOf(o.platform);return i===s?e.text.startsWith(t)&&!o.text.startsWith(t)?-1:!e.text.startsWith(t)&&o.text.startsWith(t)?1:e.text.localeCompare(o.text):i-s})}(gi.findMatchingEmotes(e,Uo.options.emotes),e)}else _i()}function zi(e){Ui=Ui||document.querySelector("#autocomplete-preview");const t=Ui.children.length>0;if(!(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey)){if(e.key===Oi.up&&t)return e.preventDefault(),void(Ei.selectedIndex>0?Ei.selectedIndex--:Ei.selectedIndex=Ei.emojiList.length-1);if(e.key===Oi.down&&t)return e.preventDefault(),void(Ei.selectedIndex<Ei.emojiList.length-1?Ei.selectedIndex++:Ei.selectedIndex=0);if((e.key===Oi.enter||e.key===Oi.tab)&&t){e.preventDefault(),e.stopImmediatePropagation();return void Mi(e.target,Ei.selectedIndex)}e.key!==Oi.enter||t||e.shiftKey?e.key===Oi.esc&&t?_i():Li(e):setTimeout(()=>{window.QueUp.room.chat.resizeTextarea()},10)}}function Qi(e){Ui=Ui||document.querySelector("#autocomplete-preview");const t=0===Ui.children.length,n=[Oi.tab,Oi.enter,Oi.up,Oi.down].includes(e.key),o=e.shiftKey||e.ctrlKey||e.altKey||e.metaKey;o||t||!n?o||e.key!==Oi.enter?o||window.QueUp.room.chat.ncKeyDown(e):(window.QueUp.room.chat.sendMessage(),window.QueUp.room.chat.resizeTextarea()):e.preventDefault()}const $i={id:"autocomplete",label:"autocomplete.label",category:"general",description:"autocomplete.description",turnOn(){Ui=document.querySelector("#autocomplete-preview"),_i(),Ci=window.QueUp.room.chat.events["keydown #chat-txt-message"];const e={...window.QueUp.room.chat.events};delete e["keydown #chat-txt-message"],window.QueUp.room.chat.delegateEvents(e);const t=ho();t.addEventListener("keydown",Qi),t.addEventListener("keyup",zi),t.addEventListener("click",Li)},turnOff(){_i(),window.QueUp.room.chat.events["keydown #chat-txt-message"]=Ci,window.QueUp.room.chat.delegateEvents(window.QueUp.room.chat.events);const e=ho();e.removeEventListener("keydown",Qi),e.removeEventListener("keyup",zi),e.removeEventListener("click",Li)}},Ai="custom-mentions";function Ii(e){const t=Uo.options[Ai],n=Uo.custom[Ai];if(t&&window.QueUp.session.id!==e.user.userInfo.userid){n.split(",").some(function(t){return new RegExp(`\\b@?${t.trim()}\\b`,"ig").test(e.message)})&&window.QueUp.room.chat.mentionChatSound.play()}}const Ti={id:Ai,label:`${Ai}.label`,description:`${Ai}.description`,category:"general",custom:{title:`${Ai}.modal.title`,content:`${Ai}.modal.content`,placeholder:`${Ai}.modal.placeholder`,maxlength:255},turnOn(){window.QueUp.Events.bind(ai,Ii)},turnOff(){window.QueUp.Events.unbind(ai,Ii)}},Ni="chat-cleaner";function Di(e){const t=go();if(!(!(null==t?void 0:t.length)||isNaN(e)||t.length<e))for(let n=0;n<t.length-e;n++)t[n].remove()}function qi(){const e=Uo.custom[Ni];if("number"==typeof e)Di(e);else if("string"==typeof e&&""!==e.trim()){Di(parseInt(e,10))}}const ji={id:Ni,label:`${Ni}.label`,description:`${Ni}.description`,category:"general",custom:{title:`${Ni}.modal.title`,content:`${Ni}.modal.content`,placeholder:`${Ni}.modal.placeholder`,maxlength:5,validation(e){if(""===e.trim())return!0;const t=parseInt(e,10);return!(e.includes(".")||isNaN(t)||t<1)||oo(`${Ni}.modal.validation`)},onConfirm:e=>{Uo.options[Ni]&&Di(parseInt(e,10))}},turnOn(){Di(void 0),window.QueUp.Events.bind(ai,qi)},turnOff(){window.QueUp.Events.unbind(ai,qi)}},Pi=Xe({isActive:!0}),Fi=[],Bi=[];function Vi(e){Pi.isActive&&(["blur","pagehide"].includes(e.type)||document.hidden)?(Pi.isActive=!1,Fi.forEach(e=>e())):Pi.isActive||!["focus","pageshow"].includes(e.type)&&document.hidden||(Pi.isActive=!0,Bi.forEach(e=>e()))}function Ri(){ro({title:oo("Notifcation.permission.title"),content:oo("Notification.permission.denied"),open:!0})}function Wi(){return new Promise((e,t)=>"Notification"in window?"granted"!==Notification.permission?"denied"===Notification.permission?(Ri(),void t()):void Notification.requestPermission().then(function(n){if("denied"===n||"default"===n)return Ri(),void t();e()}):void e():(ro({open:!0,title:oo("Notifcation.permission.title"),content:oo("Notification.permission.notSupported")}),void t(!1)))}function Ji(e){const t=Object.assign({},{content:"",ignoreActiveTab:!1,callback:null,wait:1e4},e);if(Pi.isActive&&!t.ignoreActiveTab)return;const n={body:t.content,icon:"https://cdn.jsdelivr.net/gh/DubPlus/DubPlus/images/dubplus.svg"},o=new Notification(t.title,n);o.onclick=function(){window.focus(),"function"==typeof t.callback&&t.callback(),o.close()},setTimeout(o.close.bind(o),t.wait)}function Ki(e){const t=e.message;let n=["@"+window.QueUp.session.get("username").toLowerCase()];Uo.options["custom-mentions"]&&Uo.custom["custom-mentions"]&&(n=n.concat(Uo.custom["custom-mentions"].split(",")).map(e=>e.trim()),n=n.concat(n.map(e=>"@"+e)));new RegExp(`\\b(${n.join("|")})\\b`,"ig").test(t)&&!Pi.isActive&&window.QueUp.session.id!==e.user.userInfo.userid&&Ji({title:`Message from ${e.user.username}`,content:t})}document.addEventListener("visibilitychange",Vi),window.onpageshow=Vi,window.onpagehide=Vi,window.onfocus=Vi,window.onblur=Vi,void 0!==document.hidden&&Vi({type:document.hidden?"blur":"focus"});const Hi={id:"mention-notifications",label:"mention-notifications.label",description:"mention-notifications.description",category:"general",turnOn(){Wi().then(()=>{window.QueUp.Events.bind(ai,Ki)}).catch(()=>{Uo.options[this.id]=!1})},turnOff(){window.QueUp.Events.unbind(ai,Ki)}};function Yi(e){window.QueUp.session.id!==e.userid&&Ji({title:oo("pm-notifications.notification.title"),ignoreActiveTab:!0,callback:function(){const t=document.querySelector(".user-messages");null==t||t.click(),setTimeout(function(){const t=(n=e.messageid,document.querySelector(`.message-item[data-messageid="${n}"]`));var n;null==t||t.click()},500)},wait:1e4})}const Xi={id:"pm-notifications",label:"pm-notifications.label",description:"pm-notifications.description",category:"general",turnOn(){Wi().then(()=>{window.QueUp.Events.bind(li,Yi)}).catch(()=>{Uo.options[this.id]=!1})},turnOff(){window.QueUp.Events.unbind(li,Yi)}},Gi="dj-notification";function Zi(e){e&&e.startTime>2||setTimeout(()=>{var e,t,n,o;const i=null==(t=null==(e=ko())?void 0:e.textContent)?void 0:t.trim();if(!i)return;const s=parseInt(i,10);if(isNaN(s))return void Yn(Gi,"Could not parse current position:",i);let r=parseInt(Uo.custom[Gi],10);isNaN(r)&&(r=2,Hn(Gi,"Could not parse setting, defaulting to 2"));return(null==(o=null==(n=document.querySelector(".queue-total"))?void 0:n.textContent)?void 0:o.trim())===i&&0===r||s===r?(Ji({title:oo(`${Gi}.notification.title`),content:oo(`${Gi}.notification.content`),ignoreActiveTab:!0,wait:1e4}),void window.QueUp.room.chat.mentionChatSound.play()):void 0},1e3)}const es={id:Gi,label:`${Gi}.label`,description:`${Gi}.description`,category:"general",custom:{title:`${Gi}.modal.title`,content:`${Gi}.modal.content`,placeholder:"2",defaultValue:"2",maxlength:3,validation(e){if(""===e.trim())return!0;const t=parseInt(e,10);return!(e.includes(".")||isNaN(t)||t<0)||oo(`${Gi}.modal.validation`)},onConfirm:()=>{Uo.options[Gi]&&Zi()}},turnOn(){Wi().then(()=>{Zi(),window.QueUp.Events.bind(ri,Zi)})},turnOff(){window.QueUp.Events.unbind(ri,Zi)}},ts=Xe({upDubs:[],downDubs:[],grabs:[]});const ns=window.location.hostname.includes("staging")?"https://staging-api.queup.dev":"https://api.queup.net";function os(e){return new Promise((t,n)=>{var o,i,s;const r=null==(s=null==(i=null==(o=window.QueUp.room.users.collection.findWhere({userid:e}))?void 0:o.attributes)?void 0:i._user)?void 0:s.username;r?t(r):fetch(function(e){return`${ns}/user/${e}`}(e)).then(e=>e.json()).then(o=>{var i;if(null==(i=null==o?void 0:o.userinfo)?void 0:i.username){const{username:e}=o.userinfo;t(e)}else n("Failed to get username from API for userid: "+e)}).catch(n)})}function is(){ts.downDubs=[],ts.upDubs=[],ts.grabs=[];const e=(t=window.QueUp.room.model.id,`${ns}/room/${t}/playlist/active/dubs`);var t;fetch(e).then(e=>e.json()).then(e=>{var t,n;null==(t=e.data.upDubs)||t.forEach(e=>{ts.upDubs.find(t=>t.userid===e.userid)||os(e.userid).then(t=>{ts.upDubs.push({userid:e.userid,username:t})}).catch(e=>Yn("Failed to get username for upDubs:",e))}),Go(window.QueUp.session.id)&&(null==(n=e.data.downDubs)||n.forEach(e=>{ts.downDubs.find(t=>t.userid===e.userid)||os(e.userid).then(t=>{ts.downDubs.push({userid:e.userid,username:t})}).catch(e=>Yn("Failed to get username for downDubs",e))}))}).catch(e=>Yn("Failed to fetch dubs data from API.",e))}function ss(e){"updub"===e.dubtype?(ts.upDubs.find(t=>t.userid===e.user._id)||ts.upDubs.push({userid:e.user._id,username:e.user.username}),ts.downDubs=ts.downDubs.filter(t=>t.userid!==e.user._id)):"downdub"===e.dubtype&&Go(window.QueUp.session.id)&&(ts.downDubs.find(t=>t.userid===e.user._id)||ts.downDubs.push({userid:e.user._id,username:e.user.username}),ts.upDubs=ts.upDubs.filter(t=>t.userid!==e.user._id));Date.now()-window.QueUp.room.player.activeSong.attributes.song.played<1e3||(ts.upDubs.length!==window.QueUp.room.player.activeSong.attributes.song.updubs||Go(window.QueUp.session.id)&&ts.downDubs.length!==window.QueUp.room.player.activeSong.attributes.song.downdubs)&&is()}function rs(e){ts.grabs.find(t=>t.userid===e.user._id)||ts.grabs.push({userid:e.user._id,username:e.user.username})}function as(e){ts.upDubs=ts.upDubs.filter(t=>t.userid!==e.user._id),ts.downDubs=ts.downDubs.filter(t=>t.userid!==e.user._id),ts.grabs=ts.grabs.filter(t=>t.userid!==e.user._id)}const ls={id:"dubs-hover",label:"dubs-hover.label",description:"dubs-hover.description",category:"general",turnOn(){is(),window.QueUp.Events.bind(oi,ss),window.QueUp.Events.bind(ii,rs),window.QueUp.Events.bind(si,as),window.QueUp.Events.bind(ri,is)},turnOff(){window.QueUp.Events.unbind(oi,ss),window.QueUp.Events.unbind(ii,rs),window.QueUp.Events.unbind(si,as),window.QueUp.Events.unbind(ri,is)}};function us(e){window.QueUp.session.id===window.QueUp.room.player.activeSong.attributes.song.userid&&"downdub"===e.dubtype&&di("dubplus-chat-system-downdub",oo("downdubs-in-chat.chat-message",{username:e.user.username,song_name:window.QueUp.room.player.activeSong.attributes.songInfo.name}))}const cs={id:"downdubs-in-chat",label:"downdubs-in-chat.label",description:"downdubs-in-chat.description",category:"general",modOnly:!0,turnOn(){Go(window.QueUp.session.id)&&window.QueUp.Events.bind(oi,us)},turnOff(){window.QueUp.Events.unbind(oi,us)}};function ds(e){window.QueUp.session.id===window.QueUp.room.player.activeSong.attributes.song.userid&&"updub"===e.dubtype&&di("dubplus-chat-system-updub",oo("updubs-in-chat.chat-message",{username:e.user.username,song_name:window.QueUp.room.player.activeSong.attributes.songInfo.name}))}const fs={id:"updubs-in-chat",label:"updubs-in-chat.label",description:"updubs-in-chat.description",category:"general",turnOn(){window.QueUp.Events.bind(oi,ds)},turnOff(){window.QueUp.Events.unbind(oi,ds)}};function ps(e){window.QueUp.session.id===window.QueUp.room.player.activeSong.attributes.song.userid&&di("dubplus-chat-system-grab",oo("grabs-in-chat.chat-message",{username:e.user.username,song_name:window.QueUp.room.player.activeSong.attributes.songInfo.name}))}const ms={id:"grabs-in-chat",label:"grabs-in-chat.label",description:"grabs-in-chat.description",category:"general",turnOn(){window.QueUp.room.model.get("displayUserGrab")||window.QueUp.Events.bind("realtime:room_playlist-queue-update-grabs",ps)},turnOff(){window.QueUp.room.model.get("displayUserGrab")||window.QueUp.Events.unbind("realtime:room_playlist-queue-update-grabs",ps)}},vs={id:"snow",label:"snow.label",description:"snow.description",category:"general",turnOn(){},turnOff(){}};class hs{constructor(){this.particles=[],this.drops=[],this.numbase=5,this.numb=2,this.width=0,this.height=0,this.controls={rain:2,alpha:1,color:200,opacity:1,saturation:100,lightness:50,back:0,multi:!1,speed:1},this.requestAnimFrame=null,this.canvas=null}makeCanvas(){this.canvas=document.createElement("canvas"),this.canvas.id="dubPlusRainCanvas",this.canvas.style.position="fixed",this.canvas.style.top="0px",this.canvas.style.left="0px",this.canvas.style.zIndex="100",this.canvas.style.pointerEvents="none",document.body.prepend(this.canvas)}start(){this.makeCanvas(),this.startAnimation()}stop(){var e;this.stopAnimation(),null==(e=this.canvas)||e.remove()}onWindowResize(){this.width=this.canvas.width=window.innerWidth,this.height=this.canvas.height=window.innerHeight}startAnimation(){const e=window.requestAnimationFrame;if(this.requestAnimFrame=e?e.bind(window):null,!this.canvas)return;const t=this.canvas.getContext("2d");this.width,this.height=0,this.onWindowResize(),window.onresize=this.onWindowResize.bind(this),this.particles=[],this.drops=[],this.numbase=5,this.numb=2;let n=this;!function e(){n.requestAnimFrame(e),n.update(),n.rendu(t)}()}buildRainParticle(e,t,n){for(n||(n=this.numb);n--;)this.particles.push({speedX:.25*Math.random(),speedY:9*Math.random()+1,X:e,Y:t,alpha:1,color:"hsla("+this.controls.color+","+this.controls.saturation+"%, "+this.controls.lightness+"%,"+this.controls.opacity+")"})}explosion(e,t,n,o){for(o||(o=this.numbase);o--;)this.drops.push({speedX:4*Math.random()-2,speedY:-4*Math.random(),X:e,Y:t,radius:.65+Math.floor(1.6*Math.random()),alpha:1,color:n})}rendu(e){this.controls.multi&&(this.controls.color=360*Math.random()),e.save(),e.clearRect(0,0,this.width,this.height);const t=this.particles,n=this.drops,o=2*Math.PI;for(let n,o=0;n=t[o];o++)e.globalAlpha=n.alpha,e.fillStyle=n.color,e.fillRect(n.X,n.Y,n.speedY/4,n.speedY);for(let t,i=0;t=n[i];i++)e.globalAlpha=t.alpha,e.fillStyle=t.color,e.beginPath(),e.arc(t.X,t.Y,t.radius,0,o),e.fill();e.strokeStyle="white",e.lineWidth=2,e.restore()}update(){const e=this.particles,t=this.drops;for(let t,n=0;t=e[n];n++)t.X+=t.speedX,t.Y+=t.speedY+5,t.Y>this.height-15&&(e.splice(n--,1),this.explosion(t.X,t.Y,t.color));for(let e,n=0;e=t[n];n++)e.X+=e.speedX,e.Y+=e.speedY,e.radius-=.075,e.alpha>0?e.alpha-=.005:e.alpha=0,e.radius<0&&t.splice(n--,1);let n=this.controls.rain;for(;n--;)this.buildRainParticle(Math.floor(Math.random()*this.width),-15)}stopAnimation(){this.requestAnimFrame=function(){}}}const bs={id:"rain",label:"rain.label",description:"rain.description",category:"general",turnOn(){this.rainEffect=new hs,this.rainEffect.start()},turnOff(){this.rainEffect.stop(),delete this.rainEffect}};var gs=wn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M448 344v112a23.9 23.9 0 0 1 -24 24H312c-21.4 0-32.1-25.9-17-41l36.2-36.2L224 295.6 116.8 402.9 153 439c15.1 15.1 4.4 41-17 41H24a23.9 23.9 0 0 1 -24-24V344c0-21.4 25.9-32.1 41-17l36.2 36.2L184.5 256 77.2 148.7 41 185c-15.1 15.1-41 4.4-41-17V56a23.9 23.9 0 0 1 24-24h112c21.4 0 32.1 25.9 17 41l-36.2 36.2L224 216.4l107.2-107.3L295 73c-15.1-15.1-4.4-41 17-41h112a23.9 23.9 0 0 1 24 24v112c0 21.4-25.9 32.1-41 17l-36.2-36.2L263.5 256l107.3 107.3L407 327.1c15.1-15.2 41-4.5 41 16.9z"></path></svg>');const ws={id:"fullscreen",label:"fullscreen.label",description:"fullscreen.description",category:"user-interface",altIcon:function(e){xn(e,gs())},onClick(){const e=document.querySelector(".player_container iframe");e?e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen():Hn("Fullscreen: No video element found")}},ys={id:"split-chat",label:"split-chat.label",description:"split-chat.description",category:"user-interface",turnOn(){document.body.classList.add("dubplus-split-chat")},turnOff(){document.body.classList.remove("dubplus-split-chat")}},ks={id:"hide-chat",label:"hide-chat.label",description:"hide-chat.description",category:"user-interface",turnOn(){document.body.classList.add("dubplus-video-only")},turnOff(){document.body.classList.remove("dubplus-video-only")}},xs={id:"hide-video",label:"hide-video.label",description:"hide-video.description",category:"user-interface",turnOn(){document.body.classList.add("dubplus-chat-only")},turnOff(){document.body.classList.remove("dubplus-chat-only")}},Es={id:"hide-avatars",label:"hide-avatars.label",description:"hide-avatars.description",category:"user-interface",turnOn(){document.body.classList.add("dubplus-hide-avatars")},turnOff(){document.body.classList.remove("dubplus-hide-avatars")}},_s={id:"hide-bg",label:"hide-bg.label",description:"hide-bg.description",category:"user-interface",turnOn(){document.body.classList.add("dubplus-hide-bg")},turnOff(){document.body.classList.remove("dubplus-hide-bg")}},Ss={id:"show-timestamps",label:"show-timestamps.label",description:"show-timestamps.description",category:"user-interface",turnOn(){document.body.classList.add("dubplus-show-timestamp")},turnOff(){document.body.classList.remove("dubplus-show-timestamp")}};function Os(e){const t=e.target.tagName.toLowerCase();" "===e.key&&"input"!==t&&"textarea"!==t&&window.QueUp.room.player.mutePlayer()}const Cs={id:"spacebar-mute",label:"spacebar-mute.label",description:"spacebar-mute.description",category:"settings",turnOn(){document.addEventListener("keypress",Os)},turnOff(){document.removeEventListener("keypress",Os)}};function Us(e){let t="You are leaving";return e.returnValue=t,t}const Ms={id:"warn-redirect",label:"warn-redirect.label",description:"warn-redirect.description",category:"settings",turnOn(){window.addEventListener("beforeunload",Us)},turnOff(){window.removeEventListener("beforeunload",Us)}},Ls="dubplus",zs="4.1.2",Qs="Dub+ - A simple script/extension for QueUp.net",$s="MIT",As="https://dub.plus";function Is(e,t){var n;return null==(n=document.querySelector(`style#${t}`))||n.remove(),fetch(e).then(e=>e.text()).then(e=>{const n=document.createElement("style");n.id=t,n.textContent=e,document.head.appendChild(n)})}const Ts="dubplus-community-css",Ns={id:"community-theme",label:"community-theme.label",description:"community-theme.description",category:"customize",turnOn(){const e=window.QueUp.room.model.get("roomUrl");fetch(`https://api.queup.net/room/${e}`).then(e=>e.json()).then(e=>{const t=e.data.description,n=new RegExp(/(@dub(x|plus|\+)=)((https?:\/\/)?[\w-]+(\.[\w-]+)+\.?(:\d+)?(\/\S*)?)/,"i");let o=null;if(t.replace(n,function(e,t,n,i){o=i}),o)return Hn("loading community css theme from:",o),Is(o,Ts);Hn("No community CSS theme found")}).catch(e=>{Yn("Community CSS: Failed to load room info",e)})},turnOff(){var e;null==(e=document.getElementById(Ts))||e.remove()}},Ds="dubplus-user-custom-css",qs={id:"custom-css",label:"custom-css.label",description:"custom-css.description",category:"customize",custom:{title:"custom-css.modal.title",content:"custom-css.modal.content",placeholder:"custom-css.modal.placeholder",maxlength:500,validation:e=>""===e.trim()||(!!/^http.+\.css$/.test(e)||oo("custom-css.modal.validation")),onConfirm(e){var t;if(!e)return null==(t=document.getElementById(Ds))||t.remove(),void(Uo.options[qs.id]=!1);Is(e,Ds).catch(e=>{Yn("Error loading custom css file:",e)})}},turnOn(){Uo.custom[this.id]&&Is(Uo.custom[this.id],Ds).catch(e=>{Yn("Error loading custom css file:",e)})},turnOff(){var e;null==(e=document.getElementById(Ds))||e.remove()}};function js(e){const t=yo();t&&(t.setAttribute("data-original",t.src),t.src=e)}function Ps(){const e=yo();e&&e.hasAttribute("data-original")&&(e.src=e.getAttribute("data-original"),e.removeAttribute)}const Fs={id:"custom-bg",label:"custom-bg.label",description:"custom-bg.description",category:"customize",custom:{title:"custom-bg.modal.title",content:"custom-bg.modal.content",placeholder:"custom-bg.modal.placeholder",maxlength:500,validation:e=>""===e.trim()||(!!e.startsWith("http")||oo("custom-bg.modal.validation")),onConfirm(e){Ps(),e&&js(e)}},turnOn(){Ps();const e=Uo.custom[this.id];e&&js(e)},turnOff(){Ps()}};let Bs;const Vs={id:"custom-notification-sound",label:"custom-notification-sound.label",description:"custom-notification-sound.description",category:"customize",custom:{title:"custom-notification-sound.modal.title",content:"custom-notification-sound.modal.content",placeholder:"custom-notification-sound.modal.placeholder",maxlength:500,validation:e=>""===e.trim()||(!!window.soundManager.canPlayURL(e)||oo("custom-notification-sound.modal.validation")),onConfirm(e){e?window.QueUp.room.chat.mentionChatSound.url=e:(window.QueUp.room.chat.mentionChatSound.url=Bs,Uo.options[Vs.id]=!1)}},turnOn(){Bs=window.QueUp.room.chat.mentionChatSound.url,Uo.custom[this.id]&&(window.QueUp.room.chat.mentionChatSound.url=Uo.custom[this.id])},turnOff(){window.QueUp.room.chat.mentionChatSound.url=Bs}},Rs={id:"flip-interface",label:"flip-interface.label",description:"flip-interface.description",category:"user-interface",turnOn(){document.body.classList.add("dubplus-flip-interface")},turnOff(){document.body.classList.remove("dubplus-flip-interface")}};let Ws=null;function Js(){if(Uo.options.afk)Hn("auto-afk timer expired, but afk is already enabled");else{Hn("auto-afk timer expired, enabling afk");const e=document.querySelector("#dubplus-afk [role=switch]");null==e||e.click()}}function Ks(){let e=parseInt(Uo.custom["auto-afk"],10);isNaN(e)&&(e=30),Hn("auto-afk onBlur: starting timer for ",e,"minutes"),Ws=setTimeout(Js,60*e*1e3)}function Hs(){Ws?(Hn("auto-afk onFocus: clearing timer"),clearTimeout(Ws),Ws=null):Hn("auto-afk onFocus: no timer to clear")}const Ys={id:"auto-afk",label:"auto-afk.label",description:"auto-afk.description",category:"general",turnOn(){var e,t;t=Ks,(e=Hs)&&Bi.push(e),t&&Fi.push(t)},turnOff(){var e,t;t=Ks,(e=Hs)&&Bi.splice(Bi.indexOf(e),1),t&&Fi.splice(Fi.indexOf(t),1),Hs()},custom:{title:"auto-afk.modal.title",content:"auto-afk.modal.content",placeholder:"30",defaultValue:"30",maxlength:10,validation(e){if(""===e.trim())return!0;const t=parseInt(e,10);return!(e.includes(".")||isNaN(t)||t<1)||oo("auto-afk.modal.validation")}}};function Xs(e){if(e.user._id===window.QueUp.session.id){const e=Uo.custom["grab-response"];e&&fi(e)}}const Gs={id:"grab-response",label:"grab-response.label",description:"grab-response.description",category:"general",turnOn(){window.QueUp.Events.bind(ii,Xs)},turnOff(){window.QueUp.Events.unbind(ii,Xs)},custom:{title:"grab-response.modal.title",content:"grab-response.modal.content",placeholder:"grab-response.modal.placeholder",maxlength:255}},Zs="dubplus-collapsed",er="dubplus-collapsible-image",tr="dubplus-collapser";function nr(e){e.target instanceof HTMLButtonElement&&e.target.classList.contains(tr)&&(e.stopPropagation(),e.preventDefault(),function(e){const t=e.parentElement,n=t.querySelector("img");t.classList.contains(Zs)?(t.classList.remove(Zs),e.title="collapse image",n.setAttribute("aria-hidden","false"),e.setAttribute("aria-expanded","true")):(t.classList.add(Zs),e.title="expand image",n.setAttribute("aria-hidden","true"),e.setAttribute("aria-expanded","false"))}(e.target))}function or(e){if(e&&!e.classList.contains(er)){e.classList.add(er);const t=document.createElement("button");t.type="button",t.title="collapse image",t.setAttribute("aria-expanded","true"),t.classList.add(tr),e.appendChild(t)}}function ir(e){const t=e.querySelectorAll(".autolink-image");return Array.from(t).filter(e=>!e.classList.contains(er))}function sr(e){for(const t of e)if("childList"===t.type&&t.target.nodeType===Node.ELEMENT_NODE){const e=t.target;if(e.classList.contains("text")){ir(e).forEach(or)}}}let rr=null;const ar={id:"collapsible-images",label:"collapsible-images.label",description:"collapsible-images.description",category:"general",turnOn(){rr=new MutationObserver(sr),Gn(()=>Boolean(bo())).then(()=>{const e=bo();e?(e.addEventListener("click",nr),rr.observe(e,{childList:!0,subtree:!0,attributes:!1})):Yn("Collapsible Images: No chat container found")}),Gn(()=>Boolean(wo().length)).then(()=>{wo().forEach(or)})},turnOff(){var e;rr&&rr.disconnect(),null==(e=bo())||e.removeEventListener("click",nr),document.querySelectorAll(`.${er}`).forEach(e=>{e.classList.remove(er,Zs)}),document.querySelectorAll(`.${tr}`).forEach(e=>{e.remove()}),wo().forEach(e=>e.removeAttribute("aria-hidden"))}};var lr=wn('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504.3 273.6c4.9-4.5 7.7-10.9 7.7-17.6s-2.8-13-7.7-17.6l-112-104c-7-6.5-17.2-8.2-25.9-4.4s-14.4 12.5-14.4 22l0 56-192 0 0-56c0-9.5-5.7-18.2-14.4-22s-18.9-2.1-25.9 4.4l-112 104C2.8 243 0 249.3 0 256s2.8 13 7.7 17.6l112 104c7 6.5 17.2 8.2 25.9 4.4s14.4-12.5 14.4-22l0-56 192 0 0 56c0 9.5 5.7 18.2 14.4 22s18.9 2.1 25.9-4.4l112-104z"></path></svg>');const ur={id:"pin-menu",label:"pin-menu.label",description:"pin-menu.description",category:"user-interface",turnOn(){const e=Uo.custom[this.id]||"right";document.body.classList.add(`dubplus-pin-menu-${e}`)},turnOff(){document.body.classList.remove("dubplus-pin-menu-left"),document.body.classList.remove("dubplus-pin-menu-right")},secondaryAction:{description:"pin-menu.secondaryAction.description",icon:function(e){xn(e,lr())},onClick:()=>{const e="left"===(Uo.custom[ur.id]||"right")?"right":"left";document.body.classList.toggle("dubplus-pin-menu-left","left"===e),document.body.classList.toggle("dubplus-pin-menu-right","right"===e),Lo("custom",ur.id,e)}}},cr=[ci,vi,Ys,xi,$i,Ti,ji,ar,Hi,Xi,es,ls,cs,fs,ms,Gs,vs,bs],dr=[ws,ys,ks,xs,Es,_s,Ss,Rs,ur],fr=[Cs,Ms],pr=[Ns,qs,Fs,Vs];var mr=bn("<!> <!>",1);var vr=bn('<button id="dubplus-eta" type="button" class="icon-history eta_tooltip_t dubplus-btn-player"></button>');function hr(e,t){de(t,!0);let n=Re("ETA");function o(){var e,t;const n=null==(e=ko())?void 0:e.textContent;if(!n)return oo("Eta.tooltip.notInQueue");const o=parseInt(null==(t=document.querySelector("div.currentTime span.min"))?void 0:t.textContent),i=4*parseInt(n)-4+o;return i>=0?oo("Eta.tootltip",{minutes:i}):oo("Eta.tooltip.notInQueue")}var i=vr();$n(i,(e,t)=>null==vo?void 0:vo(e,t),()=>({to:xo})),pt(()=>{qn(i,"aria-label",Xt(n)),qn(i,"data-dp-tooltip",Xt(n))}),fn("mouseenter",i,()=>{Je(n,o(),!0)}),xn(e,i),fe()}var br=bn('<button id="dubplus-snooze" type="button" class="icon-mute snooze_btn dubplus-btn-player svelte-vqfs17"><span class="svelte-vqfs17">1</span></button>');pn(["click"]);var gr=bn('<li><div class="ac-image svelte-1o2s5rh"><img class="svelte-1o2s5rh"/></div></li>'),wr=bn('<div><div class="ac-header svelte-1o2s5rh"><span class="sr-only"> </span> <div class="tip-container" aria-hidden="true"><span class="tip-navigate"><key class="icon-upvote"></key> &amp; <key class="icon-downvote"></key> </span> <span class="tip-complete"><key>TAB</key> or <key>ENTER</key> </span> <span class="tip-close"><key>ESC</key> </span></div></div> <ul id="autocomplete-preview" class="svelte-1o2s5rh"></ul> <span class="ac-text-preview svelte-1o2s5rh"> </span></div>');function yr(e,t){de(t,!0),ct(()=>{if(Ei.emojiList.length>0&&"number"==typeof Ei.selectedIndex){const e=document.querySelector(".preview-item.selected");e&&e.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}});var n=wr();let o;var i=st(n),s=st(i),r=st(s),a=st(at(s,2)),l=at(st(a),3),u=at(a,2),c=at(st(u),3),d=at(u,2),f=at(st(d)),p=at(i,2);Cn(p,23,()=>Ei.emojiList,({src:e,text:t,platform:n,alt:o})=>e+n,(e,t,n)=>{let o=()=>Xt(t).alt;var i=gr();let s;i.__click=()=>function(e){const t=ho();Mi(t,e),t.focus()}(Xt(n));var r=st(i),a=st(r);pt(e=>{s=In(i,0,`preview-item ${Xt(t).platform}-previews`,"svelte-1o2s5rh",s,e),qn(i,"title",Xt(t).text),qn(a,"src",Xt(t).src),qn(a,"alt",o()),qn(a,"title",o())},[()=>({selected:Xt(n)===Ei.selectedIndex})]),xn(e,i)});var m=st(at(p,2));$n(n,(e,t)=>null==vo?void 0:vo(e,t),()=>({to:".pusher-chat-widget-input",position:"prepend"})),pt((e,t,i,s,a)=>{var u;o=In(n,0,"ac-preview-container svelte-1o2s5rh",null,o,e),En(r,t),En(l,` (${i??""})`),En(c,` (${s??""})`),En(f,` (${a??""})`),En(m,null==(u=Ei.emojiList[Ei.selectedIndex])?void 0:u.text)},[()=>({"ac-show":Ei.emojiList.length>0}),()=>oo("autocomplete.preview.a11y"),()=>oo("autocomplete.preview.navigate"),()=>oo("autocomplete.preview.select"),()=>oo("autocomplete.preview.close")]),xn(e,n),fe()}pn(["click"]);var kr=(e,t,n)=>t(Xt(n).username),xr=bn('<li class="preview-dubinfo-item users-previews svelte-1e954qs"><div class="dubinfo-image svelte-1e954qs"><img alt="User Avatar" class="svelte-1e954qs"/></div> <button type="button" class="dubinfo-text svelte-1e954qs"> </button></li>'),Er=bn("<li><!></li>"),_r=bn('<div role="none"><ul id="dubinfo-preview"><!></ul></div>');function Sr(e,t){de(t,!0);let n=Ee(()=>{return"updub"===(e=t.dubType)?ts.upDubs:"downdub"===e?ts.downDubs:"grab"===e?ts.grabs:[];var e}),o=Re(0),i=Re(0),s=Re("none");function r(){var e,n;return"updub"===t.dubType?null==(e=document.querySelector(".dubup"))?void 0:e.parentElement:"downdub"===t.dubType?null==(n=document.querySelector(".dubdown"))?void 0:n.parentElement:"grab"===t.dubType?document.querySelector(".add-to-playlist"):null}function a(){const e=r();if(e){const t=e.getBoundingClientRect();Je(o,window.innerWidth-t.right),Je(i,t.height-2),Je(s,"block")}else Yn(`Could not find hover target for ${t.dubType} in onHover`)}function l(e){e.relatedTarget&&e.relatedTarget.closest(".dubplus-dubs-container")||Je(s,"none")}function u(e){const t=ho();t.value=`${t.value}@${e} `.trimStart(),t.focus()}Rn(()=>{const e=r();e?(e.addEventListener("mouseenter",a),e.addEventListener("mouseleave",l)):Yn(`Could not find hover target for ${t.dubType} in onMount`)}),Wn(()=>{const e=r();e?(e.removeEventListener("mouseenter",a),e.removeEventListener("mouseleave",l)):Yn(`Could not find hover target for ${t.dubType} in onDestroy`)});var c=_r(),d=st(c);let f;var p=st(d),m=e=>{var t=kn();Cn(rt(t),17,()=>Xt(n),e=>e.userid,(e,t)=>{var n=xr(),o=st(n),i=st(o),s=at(o,2);s.__click=[kr,u,t];var r=st(s);pt(e=>{qn(i,"src",e),En(r,`@${Xt(t).username??""}`)},[()=>{return e=Xt(t).userid,`${ns}/user/${e}/image`;var e}]),xn(e,n)}),xn(e,t)},v=e=>{var n=Er(),o=st(n),i=e=>{var n=yn();pt(e=>En(n,e),[()=>oo("dubs-hover.no-votes",{dubType:t.dubType})]),xn(e,n)},s=e=>{var n=yn();pt(e=>En(n,e),[()=>oo("dubs-hover.no-grabs",{dubType:t.dubType})]),xn(e,n)};On(o,e=>{"updub"===t.dubType||"downdub"===t.dubType?e(i):e(s,!1)}),xn(e,n)};On(p,e=>{Xt(n).length>0?e(m):e(v,!1)}),$n(c,(e,t)=>null==vo?void 0:vo(e,t),()=>({to:"body"})),pt(e=>{qn(c,"id",`dubplus-${t.dubType}s-container`),In(c,0,`dubplus-dubs-container dubplus-${t.dubType}s-container`,"svelte-1e954qs"),Tn(c,`bottom: ${Xt(i)}px; right: ${Xt(o)}px; display: ${Xt(s)};`),f=In(d,0,"dubinfo-show svelte-1e954qs",null,f,e)},[()=>({"dubplus-no-dubs":0===Xt(n).length})]),fn("mouseleave",c,()=>Je(s,"none")),xn(e,c),fe()}pn(["click"]);let Or=200;const Cr=100;function Ur(){return document.getElementById("snow-container")}function Mr(e=""){const t=function(){let e=document.getElementById("psjs-css");return e||(e=document.createElement("style"),e.id="psjs-css",document.head.appendChild(e),e)}();t.textContent=e,document.head.appendChild(t)}function Lr(e=100){return Math.floor(Math.random()*e)+1}function zr(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function Qr(e,t){return Math.random()*(t-e)+e}function $r(){!function(){var e;const t=Ur();Or=Number((null==(e=null==t?void 0:t.dataset)?void 0:e.count)||Or)}(),function(e=200){let t="";for(let n=1;n<e;n++){let e=100*Math.random(),o=10*Math.random(),i=e+o,s=e+o/2,r=Qr(.3,.8),a=r*Cr,l=Math.random(),u=zr(10,30),c=-1*Lr(30);t+=`\n      .snowflake:nth-child(${n}) {\n        opacity: ${Math.random()};\n        transform: translate(${e}vw, -10px) scale(${l});\n        animation: fall-${n} ${u}s ${c}s linear infinite;\n      }\n      @keyframes fall-${n} {\n        ${100*r}% {\n          transform: translate(${i}vw, ${a}vh) scale(${l});\n        }\n        to {\n          transform: translate(${s}vw, 100vh) scale(${l});\n        }\n      }\n    `}Mr(t)}(Or),function(e=200){e-=1;const t=Ur();t.replaceChildren();for(let n=0;n<e;n++){let e=document.createElement("div");e.className="snowflake",t.appendChild(e)}}(Or)}var Ar=bn('<div id="snow-container" class="svelte-43mrfk"></div>');var Ir=bn('<li class="svelte-1nfdnng"><button type="button" class="svelte-1nfdnng"><!> <span class="dubplus-menu-label svelte-1nfdnng"> </span></button></li>');pn(["click"]);var Tr=bn("<!> <!>",1);function Nr(e,t){de(t,!1),Bn();var n=Tr(),o=rt(n);{let e=_e(()=>oo("user-interface.title"));Qo(o,{settingsId:"user-interface",get name(){return Xt(e)}})}Ao(at(o,2),{settingsId:"user-interface",children:(e,t)=>{var n=kn();Cn(rt(n),1,()=>dr,e=>e.id,(e,t)=>{var n=kn(),o=rt(n),i=e=>{!function(e,t){de(t,!0),Rn(()=>{t.init&&t.init()});var n=Ir(),o=st(n);o.__click=function(...e){var n;null==(n=t.onClick)||n.apply(this,e)};var i=st(o);Qn(i,()=>t.icon,(e,t)=>{t(e,{})});var s=st(at(i,2));pt((e,i,r)=>{qn(n,"id",t.id),qn(n,"title",e),qn(o,"aria-label",i),En(s,r)},[()=>oo(t.description),()=>oo(t.description),()=>oo(t.label)]),xn(e,n),fe()}(e,{get id(){return Xt(t).id},get label(){return Xt(t).label},get description(){return Xt(t).description},get icon(){return Xt(t).altIcon},get onClick(){return Xt(t).onClick},get init(){return Xt(t).init}})},s=e=>{ni(e,{get id(){return Xt(t).id},get label(){return Xt(t).label},get description(){return Xt(t).description},get init(){return Xt(t).init},get customize(){return Xt(t).custom},get secondaryAction(){return Xt(t).secondaryAction},get turnOn(){return Xt(t).turnOn},get turnOff(){return Xt(t).turnOff}})};On(o,e=>{Xt(t).altIcon?e(i):e(s,!1)}),xn(e,n)}),xn(e,n)}}),xn(e,n),fe()}var Dr,qr,jr=(Dr=()=>Uo,qr=Ve(0),function(){return 1===arguments.length?(Je(qr,Xt(qr)+1),arguments[0]):(Xt(qr),Dr())}),Pr=bn("<!> <!>",1);var Fr=bn("<!> <!>",1);function Br(e,t,n,o,i,s){document.body.classList.contains(t)?s():(Je(n,oo("SnoozeVideo.tooltip.undo"),!0),Je(o,"icon-eye-unblocked"),document.body.classList.add(t),window.QueUp.Events.bind(ri,i))}var Vr=bn('<button id="dubplus-snooze-video" type="button"><span class="svelte-vqfs17">1</span></button>');pn(["click"]);var Rr=bn("<!> <!> <!>",1),Wr=bn('<!> <!> <!> <!> <!> <!> <!> <aside class="dubplus-menu svelte-dbs9ys"><p class="dubplus-menu-header svelte-dbs9ys"> <span class="version svelte-dbs9ys"> </span></p> <!> <!> <!> <!> <!></aside> <!>',1);function Jr(e,t){de(t,!1),Rn(()=>{document.querySelector("html").classList.add("dubplus")}),Bn();var n=Wr(),o=rt(n);!function(e,t){de(t,!0);let n=Re(Xe(oo("Snooze.tooltip")));const o={currentVol:50,snoozed:!1};function i(){window.QueUp.room.player.setVolume(o.currentVol),window.QueUp.room.player.updateVolumeBar(),o.snoozed=!1,Je(n,oo("Snooze.tooltip"),!0),window.QueUp.Events.unbind(ri,s)}function s(e){if(e.startTime<2&&o.snoozed)return i(),!0}var r=br();r.__click=function(){!o.snoozed&&!window.QueUp.room.player.muted_player&&window.QueUp.playerController.volume>2?(Je(n,oo("Snooze.tooltip.undo"),!0),o.currentVol=window.QueUp.playerController.volume,window.QueUp.room.player.mutePlayer(),o.snoozed=!0,window.QueUp.Events.bind(ri,s)):o.snoozed&&i()},$n(r,(e,t)=>null==vo?void 0:vo(e,t),()=>({to:xo})),pt(()=>{qn(r,"aria-label",Xt(n)),qn(r,"data-dp-tooltip",Xt(n))}),xn(e,r),fe()}(o,{});var i=at(o,2);!function(e,t){de(t,!1),Bn();var n=_o();n.__click=[Eo],eo(st(n)),$n(n,(e,t)=>null==vo?void 0:vo(e,t),()=>({to:".header-right-navigation"})),xn(e,n),fe()}(i,{});var s=at(i,2);hr(s,{});var r=at(s,2);!function(e,t){de(t,!0);let n=Re("icon-eye-blocked"),o=Re(Xe(oo("SnoozeVideo.tooltip")));const i="dubplus-snooze-video";function s(){Je(o,oo("SnoozeVideo.tooltip"),!0),Je(n,"icon-eye-blocked"),document.body.classList.remove(i),window.QueUp.Events.unbind(ri,r)}function r(e){if(e.startTime<2)return s(),!0}var a=Vr();a.__click=[Br,i,o,n,r,s],$n(a,(e,t)=>null==vo?void 0:vo(e,t),()=>({to:xo})),pt(()=>{In(a,0,`${Xt(n)} snooze-video-btn dubplus-btn-player`,"svelte-vqfs17"),qn(a,"aria-label",Xt(o)),qn(a,"data-dp-tooltip",Xt(o))}),xn(e,a),fe()}(r,{});var a=at(r,2),l=e=>{yr(e,{})};On(a,e=>{Uo.options.autocomplete&&e(l)});var u=at(a,2),c=e=>{var t=Rr(),n=rt(t);Sr(n,{dubType:"updub"});var o=at(n,2);Sr(o,{dubType:"downdub"}),Sr(at(o,2),{dubType:"grab"}),xn(e,t)};On(u,e=>{Uo.options["dubs-hover"]&&e(c)});var d=at(u,2),f=e=>{!function(e,t){de(t,!1),Rn(()=>{$r(),window.addEventListener("resize",$r)}),Wn(()=>{window.removeEventListener("resize",$r)}),Bn();var n=Ar();$n(n,(e,t)=>null==vo?void 0:vo(e,t),()=>({to:"body"})),xn(e,n),fe()}(e,{})};On(d,e=>{Uo.options.snow&&e(f)});var p=at(d,2),m=st(p),v=st(m),h=st(at(v)),b=at(m,2);!function(e,t){de(t,!1),Bn();var n=mr(),o=rt(n);{let e=_e(()=>oo("general.title"));Qo(o,{settingsId:"general",get name(){return Xt(e)}})}Ao(at(o,2),{settingsId:"general",children:(e,t)=>{var n=kn();Cn(rt(n),1,()=>cr,e=>e.id,(e,t)=>{ni(e,{get id(){return Xt(t).id},get label(){return Xt(t).label},get description(){return Xt(t).description},get init(){return Xt(t).init},get customize(){return Xt(t).custom},get modOnly(){return Xt(t).modOnly},get turnOn(){return Xt(t).turnOn},get turnOff(){return Xt(t).turnOff}})}),xn(e,n)}}),xn(e,n),fe()}(b,{});var g=at(b,2);Nr(g,{});var w=at(g,2);!function(e,t){de(t,!1),fr.forEach(e=>{jr().options[e.id]||jr(jr().options[e.id]=!1)}),Bn();var n=Pr(),o=rt(n);{let e=_e(()=>oo("settings.title"));Qo(o,{settingsId:"settings",get name(){return Xt(e)}})}Ao(at(o,2),{settingsId:"settings",children:(e,t)=>{var n=kn();Cn(rt(n),1,()=>fr,e=>e.id,(e,t)=>{ni(e,{get id(){return Xt(t).id},get label(){return Xt(t).label},get description(){return Xt(t).description},get init(){return Xt(t).init},get customize(){return Xt(t).custom},get turnOn(){return Xt(t).turnOn},get turnOff(){return Xt(t).turnOff}})}),xn(e,n)}}),xn(e,n),fe()}(w,{});var y=at(w,2);!function(e,t){de(t,!1),Bn();var n=Fr(),o=rt(n);{let e=_e(()=>oo("customize.title"));Qo(o,{settingsId:"customize",get name(){return Xt(e)}})}Ao(at(o,2),{settingsId:"customize",children:(e,t)=>{var n=kn();Cn(rt(n),1,()=>pr,e=>e.id,(e,t)=>{ni(e,{get id(){return Xt(t).id},get label(){return Xt(t).label},get description(){return Xt(t).description},get init(){return Xt(t).init},get customize(){return Xt(t).custom},get turnOn(){return Xt(t).turnOn},get turnOff(){return Xt(t).turnOff}})}),xn(e,n)}}),xn(e,n),fe()}(y,{}),function(e,t){de(t,!1),Bn();var n=Wo(),o=rt(n);{let e=_e(()=>oo("contact.title"));Qo(o,{settingsId:"contact",get name(){return Xt(e)}})}Ao(at(o,2),{settingsId:"contact",children:(e,t)=>{var n=Ro(),o=rt(n);{let e=_e(()=>oo("contact.bugs"));To(o,{get icon(){return Do},href:"https://discord.gg/XUkG3Qy",get text(){return Xt(e)}})}var i=at(o,2);To(i,{get icon(){return jo},href:"https://www.reddit.com/r/DubPlus/",text:"Reddit"});var s=at(i,2);To(s,{get icon(){return Fo},href:"https://facebook.com/DubPlusScript",text:"Facebook"}),To(at(s,2),{get icon(){return Vo},href:"https://twitter.com/DubPlusScript",text:"Twitter"}),xn(e,n)}}),xn(e,n),fe()}(at(y,2),{}),mo(at(p,2),{}),pt(e=>{En(v,`${e??""} `),En(h,`v${zs}`)},[()=>oo("Menu.title")]),xn(e,n),fe()}const Kr="dubplusExtensionLoaded"in window;var Hr,Yr;Hn("loaded as extension:",Kr),Kr||(Hr="/dubplus.css",Yr="dubplus-css",Hr=Hr.replace(/^\//,""),new Promise((e,t)=>{var n;null==(n=document.querySelector(`link.${Yr}`))||n.remove();const o=zs;let i="DubPlus";const s="develop".trim();s&&(i+="main"===s||"master"===s?"@latest":`@${s}`);const r=function(e,t){const n=document.createElement("link");return n.rel="stylesheet",n.type="text/css",n.className=e,n.href=t,n}(Yr,`//cdn.jsdelivr.net/gh/DubPlus/${i}/${Hr}?${o}`);r.onload=()=>e(),r.onerror=t,document.head.appendChild(r)})).catch(e=>{Yn("Failed to load dubplus.css",e)});let Xr=document.getElementById("dubplus-container");Xr?Xr.children.length>0&&(!function(e,t){const n=Sn.get(e);n?(Sn.delete(e),n(t)):Promise.resolve()}(Xr),Xr.replaceChildren()):(Xr=document.createElement("div"),Xr.id="dubplus-container",document.body.appendChild(Xr));const Gr=function(e,{target:t,anchor:n,props:o={},events:i,context:s,intro:r=!0}){!function(){if(void 0===Ge){Ge=window,Ze=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;et=C(t,"firstChild").get,tt=C(t,"nextSibling").get,Q(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Q(n)&&(n.__t=void 0)}}();var a=new Set,l=e=>{for(var n=0;n<e.length;n++){var o=e[n];if(!a.has(o)){a.add(o);var i=rn(o);t.addEventListener(o,mn,{passive:i});var s=_n.get(o);void 0===s?(document.addEventListener(o,mn,{passive:i}),_n.set(o,1)):_n.set(o,s+1)}}};l(S(cn)),dn.add(l);var u=void 0,c=function(e){qe.ensure();const t=ut(N,e,!0);return(e={})=>new Promise(n=>{e.outro?yt(t,()=>{gt(t),n(void 0)}):(gt(t),n(void 0))})}(()=>{var r=n??t.appendChild(nt());return vt(()=>{s&&(de({}),ue.c=s),i&&(o.$$events=i),u=e(r,o)||{},s&&fe()}),()=>{var e;for(var o of a){t.removeEventListener(o,mn);var i=_n.get(o);0===--i?(document.removeEventListener(o,mn),_n.delete(o)):_n.set(o,i)}dn.delete(l),r!==n&&(null==(e=r.parentNode)||e.removeChild(r))}});return Sn.set(u,c),u}(function(e,t){de(t,!0),window.dubplus=Object.assign(window.dubplus||{},{name:Ls,version:zs,description:Qs,license:$s,homepage:As});let n=Re("loading");const o=["QueUp.session.id","QueUp.room.chat","QueUp.Events","QueUp.room.player","QueUp.helpers.cookie","QueUp.room.model","QueUp.room.users"];function i(e){so.title=oo("Error.modal.title"),so.content=e,so.open=!0}Gn(function(){return function(e,t=window){const n=t;for(let t=0;t<e.length;t++)if(!Xn(e[t],n))return Hn(e[t],"is not found yet"),!1;return!0}(o)}).then(()=>{Je(n,"ready")}).catch(()=>{var e,t;(null==(t=null==(e=window.QueUp)?void 0:e.session)?void 0:t.id)?Je(n,"error"):Je(n,"loggedout")}),ct(()=>{"loggedout"===Xt(n)?i(oo("Error.modal.loggedout")):"error"===Xt(n)&&i(oo("Error.unknown"))});var s=kn(),r=rt(s),a=e=>{!function(e,t){de(t,!1),Bn();var n=io(),o=st(n);eo(st(o));var i=st(at(o,2));pt(e=>En(i,e),[()=>oo("Loading.text")]),xn(e,n),fe()}(e,{})},l=e=>{var t=kn(),o=rt(t),i=e=>{Jr(e,{})},s=e=>{mo(e,{})};On(o,e=>{"ready"===Xt(n)?e(i):e(s,!1)},!0),xn(e,t)};On(r,e=>{"loading"===Xt(n)?e(a):e(l,!1)}),xn(e,s),fe()},{target:Xr});return Gr}();
