
/*
     /$$$$$$$            /$$                
    | $$__  $$          | $$          /$$   
    | $$  | $$ /$$   /$$| $$$$$$$    | $$   
    | $$  | $$| $$  | $$| $$__  $$ /$$$$$$$$
    | $$  | $$| $$  | $$| $$  | $$|__  $$__/
    | $$  | $$| $$  | $$| $$  | $$   | $$   
    | $$$$$$$/|  $$$$$$/| $$$$$$$/   |__/   
    |_______/  ______/ |_______/           
                                            
                                            
    https://github.com/DubPlus/DubPlus

    This source code is licensed under the MIT license 
    found here: https://github.com/DubPlus/DubPlus/blob/master/LICENSE

    Copyright (c) 2017-present DubPlus

    more info at https://dub.plus
*/
var DubPlus=function(){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?l(e):t}function p(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var f=function(){},i={},h=[],m=[];function v(e,t){var n,o,r,i,s=m;for(i=arguments.length;2<i--;)h.push(arguments[i]);for(t&&null!=t.children&&(h.length||h.push(t.children),delete t.children);h.length;)if((o=h.pop())&&void 0!==o.pop)for(i=o.length;i--;)h.push(o[i]);else"boolean"==typeof o&&(o=null),(r="function"!=typeof e)&&(null==o?o="":"number"==typeof o?o=String(o):"string"!=typeof o&&(r=!1)),r&&n?s[s.length-1]+=o:s===m?s=[o]:s.push(o),n=r;var a=new f;return a.nodeName=e,a.children=s,a.attributes=null==t?void 0:t,a.key=null==t?void 0:t.key,a}function O(e,t){for(var n in t)e[n]=t[n];return e}function b(e,t){null!=e&&("function"==typeof e?e(t):e.current=t)}var t="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,y=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,g=[];function w(e){!e._dirty&&(e._dirty=!0)&&1==g.push(e)&&t(k)}function k(){for(var e;e=g.pop();)e._dirty&&U(e)}function C(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function x(e){var t=O({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var o in n)void 0===t[o]&&(t[o]=n[o]);return t}function N(e){var t=e.parentNode;t&&t.removeChild(e)}function D(e,t,n,o,r){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)b(n,null),b(o,e);else if("class"!==t||r)if("style"===t){if(o&&"string"!=typeof o&&"string"!=typeof n||(e.style.cssText=o||""),o&&"object"==typeof o){if("string"!=typeof n)for(var i in n)i in o||(e.style[i]="");for(var i in o)e.style[i]="number"==typeof o[i]&&!1===y.test(i)?o[i]+"px":o[i]}}else if("dangerouslySetInnerHTML"===t)o&&(e.innerHTML=o.__html||"");else if("o"==t[0]&&"n"==t[1]){var s=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),o?n||e.addEventListener(t,S,s):e.removeEventListener(t,S,s),(e._listeners||(e._listeners={}))[t]=o}else if("list"!==t&&"type"!==t&&!r&&t in e){try{e[t]=null==o?"":o}catch(e){}null!=o&&!1!==o||"spellcheck"==t||e.removeAttribute(t)}else{var a=r&&t!==(t=t.replace(/^xlink:?/,""));null==o||!1===o?a?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof o&&(a?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),o):e.setAttribute(t,o))}else e.className=o||""}function S(e){return this._listeners[e.type](e)}var E=[],T=0,A=!1,M=!1;function I(){for(var e;e=E.shift();)e.componentDidMount&&e.componentDidMount()}function P(e,t,n,o,r,i){T++||(A=null!=r&&void 0!==r.ownerSVGElement,M=null!=e&&!("__preactattr_"in e));var s=L(e,t,n,o,i);return r&&s.parentNode!==r&&r.appendChild(s),--T||(M=!1,i||I()),s}function L(e,t,n,o,r){var i=e,s=A;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||r)?e.nodeValue!=t&&(e.nodeValue=t):(i=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(i,e),W(e,!0))),i.__preactattr_=!0,i;var a,u,c=t.nodeName;if("function"==typeof c)return function(e,t,n,o){var r=e&&e._component,i=r,s=e,a=r&&e._componentConstructor===t.nodeName,u=a,c=x(t);for(;r&&!u&&(r=r._parentComponent);)u=r.constructor===t.nodeName;r&&u&&(!o||r._component)?(B(r,c,3,n,o),e=r.base):(i&&!a&&(z(i),e=s=null),r=R(t.nodeName,c,n),e&&!r.nextBase&&(r.nextBase=e,s=null),B(r,c,1,n,o),e=r.base,s&&e!==s&&(s._component=null,W(s,!1)));return e}(e,t,n,o);if(A="svg"===c||"foreignObject"!==c&&A,c=String(c),(!e||!C(e,c))&&(a=c,(u=A?document.createElementNS("http://www.w3.org/2000/svg",a):document.createElement(a)).normalizedNodeName=a,i=u,e)){for(;e.firstChild;)i.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(i,e),W(e,!0)}var l=i.firstChild,d=i.__preactattr_,p=t.children;if(null==d){d=i.__preactattr_={};for(var f=i.attributes,h=f.length;h--;)d[f[h].name]=f[h].value}return!M&&p&&1===p.length&&"string"==typeof p[0]&&null!=l&&void 0!==l.splitText&&null==l.nextSibling?l.nodeValue!=p[0]&&(l.nodeValue=p[0]):(p&&p.length||null!=l)&&function(e,t,n,o,r){var i,s,a,u,c,l=e.childNodes,d=[],p={},f=0,h=0,m=l.length,v=0,b=t?t.length:0;if(0!==m)for(var y=0;y<m;y++){var g=l[y],w=g.__preactattr_,k=b&&w?g._component?g._component.__key:w.key:null;null!=k?(f++,p[k]=g):(w||(void 0!==g.splitText?!r||g.nodeValue.trim():r))&&(d[v++]=g)}if(0!==b)for(var y=0;y<b;y++){u=t[y],c=null;var k=u.key;if(null!=k)f&&void 0!==p[k]&&(c=p[k],p[k]=void 0,f--);else if(h<v)for(i=h;i<v;i++)if(void 0!==d[i]&&(D=s=d[i],S=r,"string"==typeof(_=u)||"number"==typeof _?void 0!==D.splitText:"string"==typeof _.nodeName?!D._componentConstructor&&C(D,_.nodeName):S||D._componentConstructor===_.nodeName)){c=s,d[i]=void 0,i===v-1&&v--,i===h&&h++;break}c=L(c,u,n,o),a=l[y],c&&c!==e&&c!==a&&(null==a?e.appendChild(c):c===a.nextSibling?N(a):e.insertBefore(c,a))}var D,_,S;if(f)for(var y in p)void 0!==p[y]&&W(p[y],!1);for(;h<=v;)void 0!==(c=d[v--])&&W(c,!1)}(i,p,n,o,M||null!=d.dangerouslySetInnerHTML),function(e,t,n){var o;for(o in n)t&&null!=t[o]||null==n[o]||D(e,o,n[o],n[o]=void 0,A);for(o in t)"children"===o||"innerHTML"===o||o in n&&t[o]===("value"===o||"checked"===o?e[o]:n[o])||D(e,o,n[o],n[o]=t[o],A)}(i,t.attributes,d),A=s,i}function W(e,t){var n=e._component;n?z(n):(null!=e.__preactattr_&&b(e.__preactattr_.ref,null),!1!==t&&null!=e.__preactattr_||N(e),q(e))}function q(e){for(e=e.lastChild;e;){var t=e.previousSibling;W(e,!0),e=t}}var j=[];function R(e,t,n){var o,r=j.length;for(e.prototype&&e.prototype.render?(o=new e(t,n),G.call(o,t,n)):((o=new G(t,n)).constructor=e,o.render=F);r--;)if(j[r].constructor===e)return o.nextBase=j[r].nextBase,j.splice(r,1),o;return o}function F(e,t,n){return this.constructor(e,n)}function B(e,t,n,o,r){e._disable||(e._disable=!0,e.__ref=t.ref,e.__key=t.key,delete t.ref,delete t.key,void 0===e.constructor.getDerivedStateFromProps&&(!e.base||r?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,o)),o&&o!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=o),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&!1===i.syncComponentUpdates&&e.base?w(e):U(e,1,r)),b(e.__ref,e))}function U(e,t,n,o){if(!e._disable){var r,i,s,a=e.props,u=e.state,c=e.context,l=e.prevProps||a,d=e.prevState||u,p=e.prevContext||c,f=e.base,h=e.nextBase,m=f||h,v=e._component,b=!1,y=p;if(e.constructor.getDerivedStateFromProps&&(u=O(O({},u),e.constructor.getDerivedStateFromProps(a,u)),e.state=u),f&&(e.props=l,e.state=d,e.context=p,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(a,u,c)?b=!0:e.componentWillUpdate&&e.componentWillUpdate(a,u,c),e.props=a,e.state=u,e.context=c),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!b){r=e.render(a,u,c),e.getChildContext&&(c=O(O({},c),e.getChildContext())),f&&e.getSnapshotBeforeUpdate&&(y=e.getSnapshotBeforeUpdate(l,d));var g,w,k=r&&r.nodeName;if("function"==typeof k){var D=x(r);(i=v)&&i.constructor===k&&D.key==i.__key?B(i,D,1,c,!1):(g=i,e._component=i=R(k,D,c),i.nextBase=i.nextBase||h,i._parentComponent=e,B(i,D,0,c,!1),U(i,1,n,!0)),w=i.base}else s=m,(g=v)&&(s=e._component=null),(m||1===t)&&(s&&(s._component=null),w=P(s,r,c,n||!f,m&&m.parentNode,!0));if(m&&w!==m&&i!==v){var _=m.parentNode;_&&w!==_&&(_.replaceChild(w,m),g||(m._component=null,W(m,!1)))}if(g&&z(g),(e.base=w)&&!o){for(var S=e,C=e;C=C._parentComponent;)(S=C).base=w;w._component=S,w._componentConstructor=S.constructor}}for(!f||n?E.push(e):b||e.componentDidUpdate&&e.componentDidUpdate(l,d,y);e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);T||o||I()}}function z(e){var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?z(n):t&&(null!=t.__preactattr_&&b(t.__preactattr_.ref,null),N(e.nextBase=t),j.push(e),q(t)),b(e.__ref,null)}function G(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{},this._renderCallbacks=[]}function K(e,t,n){return P(n,e,{},!1,t,!1)}function Y(e,n){var o=document.createElement("script"),t=document.getElementsByTagName("script")[0];o.async=1,o.onload=o.onreadystatechange=function(e,t){(t||!o.readyState||/loaded|complete/.test(o.readyState))&&(o.onload=o.onreadystatechange=null,o=void 0,t||n&&n())},o.onerror=function(e){n&&n(e)},o.src=e,t.parentNode.insertBefore(o,t)}O(G.prototype,{setState:function(e,t){this.prevState||(this.prevState=this.state),this.state=O(O({},this.state),"function"==typeof e?e(this.state,this.props):e),t&&this._renderCallbacks.push(t),w(this)},forceUpdate:function(e){e&&this._renderCallbacks.push(e),U(this,2)},render:function(){}});var H={currentVol:50,snoozed:!1},e=function(e){if(e.startTime<2)return H.snoozed&&(Dubtrack.room.player.setVolume(H.currentVol),H.snoozed=!1),!0},V=function(){!H.snoozed&&!Dubtrack.room.player.muted_player&&2<Dubtrack.playerController.volume?(H.currentVol=Dubtrack.playerController.volume,Dubtrack.room.player.mutePlayer(),H.snoozed=!0,Dubtrack.Events.bind("realtime:room_playlist-update",e)):H.snoozed&&(Dubtrack.room.player.setVolume(H.currentVol),Dubtrack.room.player.updateVolumeBar(),H.snoozed=!1)},J={position:"absolute",font:"1rem/1.5 proxima-nova,sans-serif",display:"block",left:"-33px",cursor:"pointer",borderRadius:"1.5rem",padding:"8px 16px",background:"#fff",fontWeight:"700",fontSize:"13.6px",textTransform:"uppercase",color:"#000",opacity:"0.8",textAlign:"center",zIndex:"9"},X=function(e){function i(){var e,t;s(this,i);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return u(l(l(t=d(this,(e=c(i)).call.apply(e,[this].concat(o))))),"state",{show:!1}),u(l(l(t)),"showTooltip",function(){t.setState({show:!0})}),u(l(l(t)),"hideTooltip",function(){t.setState({show:!1})}),t}return n(i,G),a(i,[{key:"render",value:function(e,t){return v("span",{className:"icon-mute snooze_btn",onClick:V,onMouseOver:this.showTooltip,onMouseOut:this.hideTooltip},t.show&&v("div",{className:"snooze_tooltip",style:J},"Mute current song"))}}]),i}();var Q={position:"absolute",font:"1rem/1.5 proxima-nova,sans-serif",display:"block",left:"-33px",cursor:"pointer",borderRadius:"1.5rem",padding:"8px 16px",background:"#fff",fontWeight:"700",fontSize:"13.6px",textTransform:"uppercase",color:"#000",opacity:"0.8",textAlign:"center",zIndex:"9"},Z=function(e){function i(){var e,t;s(this,i);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return u(l(l(t=d(this,(e=c(i)).call.apply(e,[this].concat(o))))),"state",{show:!1,booth_time:""}),u(l(l(t)),"showTooltip",function(){var e=t.getEta();t.setState({show:!0,booth_time:e})}),u(l(l(t)),"hideTooltip",function(){t.setState({show:!1})}),t}return n(i,G),a(i,[{key:"getEta",value:function(){var e=parseInt(document.querySelector("#player-controller div.left ul li.infoContainer.display-block div.currentTime span.min").textContent),t=4*parseInt(document.querySelector(".queue-position").textContent)-4+e;return 0<=t?t:"You're not in the queue"}},{key:"render",value:function(e,t){return v("span",{className:"icon-history eta_tooltip_t",onMouseOver:this.showTooltip,onMouseOut:this.hideTooltip},this.state.show&&v("span",{className:"eta_tooltip",style:Q},this.state.booth_time))}}]),i}();function ee(e){var t="open"===e.open?"down":"right";return v("div",{id:e.id,onClick:e.onClick,className:"dubplus-menu-section-header"},v("span",{className:"fa fa-angle-".concat(t)}),v("p",null,e.category))}var te={menu:{general:"open","user-interface":"open",settings:"open",customize:"open",contact:"open"},options:{"dubplus-autovote":!1,"dubplus-emotes":!1,"dubplus-autocomplete":!1,mention_notifications:!1,dubplus_pm_notifications:!1,"dj-notification":!1,"dubplus-dubs-hover":!1,"dubplus-downdubs":!1,"dubplus-grabschat":!1,"dubplus-split-chat":!1,"dubplus-show-timestamp":!1,"dubplus-hide-bg":!1,"dubplus-hide-avatars":!1,"dubplus-chat-only":!1,"dubplus-video-only":!1,warn_redirect:!1,"dubplus-comm-theme":!1,"dubplus-afk":!1,"dubplus-snow":!1,"dubplus-custom-css":!1},custom:{customAfkMessage:"",dj_notification:1,css:""}},ne=new(function(){function n(){s(this,n),u(this,"srcRoot","https://cdn.jsdelivr.net/gh/FranciscoG/DubPlus@preact-version");var e=localStorage.getItem("dubplusUserSettings");if(e)try{var t=JSON.parse(e);this.stored=Object.assign({},te,t)}catch(e){this.stored=te}else this.stored=te}return a(n,[{key:"save",value:function(e,t,n){this.stored[e][t]=n;try{localStorage.setItem("dubplusUserSettings",JSON.stringify(this.stored))}catch(e){console.error("an error occured saving dubplus to localStorage",e)}}}]),n}()),oe=function(e){function t(){return s(this,t),d(this,c(t).apply(this,arguments))}return n(t,G),a(t,[{key:"componentDidUpdate",value:function(e){for(var t in e)if(e[t]!==this.props[t])return setTimeout(this.renderLayer)}},{key:"componentDidMount",value:function(){this.isMounted=!0,this.renderLayer=this.renderLayer.bind(this),this.renderLayer()}},{key:"componentWillUnmount",value:function(){this.renderLayer(!1),this.isMounted=!1,this.remote&&this.remote.parentNode.removeChild(this.remote)}},{key:"findNode",value:function(e){return"string"==typeof e?document.querySelector(e):e}},{key:"renderLayer",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.isMounted&&(this.props.into!==this.intoPointer&&(this.intoPointer=this.props.into,this.into&&this.remote&&(this.remote=K(v(re,null),this.into,this.remote)),this.into=this.findNode(this.props.into)),this.remote=K(v(re,{context:this.context},e&&this.props.children||null),this.into,this.remote))}},{key:"render",value:function(){return null}}]),t}(),re=function(e){function t(){return s(this,t),d(this,c(t).apply(this,arguments))}return n(t,G),a(t,[{key:"getChildContext",value:function(){return this.props.context}},{key:"render",value:function(e){var t=e.children;return t&&t[0]||null}}]),t}(),ie=function(e){function i(){var e,t;s(this,i);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return u(l(l(t=d(this,(e=c(i)).call.apply(e,[this].concat(o))))),"keyUpHandler",function(e){13===e.keyCode&&(t.props.onConfirm(t.textarea.value),t.props.onClose()),27===e.keyCode&&t.props.onClose()}),u(l(l(t)),"confirmClick",function(){t.props.onConfirm(t.textarea.value),t.props.onClose()}),t}return n(i,G),a(i,[{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.keyUpHandler)}},{key:"componentDidUpdate",value:function(){this.props.open?document.addEventListener("keyup",this.keyUpHandler):document.removeEventListener("keyup",this.keyUpHandler)}},{key:"render",value:function(e){var t=this,n=e.onConfirm?"cancel":"close";return e.open?v(oe,{into:"body"},v("div",{className:"dp-modal"},v("aside",{className:"container"},v("div",{className:"title"},v("h1",null," ",e.title||"Dub+")),v("div",{className:"content"},v("p",null,e.content||""),e.placeholder&&v("textarea",{ref:function(e){return t.textarea=e},placeholder:e.placeholder,maxlength:e.maxlength||999},e.value||"")),v("div",{className:"dp-modal-buttons"},v("button",{id:"dp-modal-cancel",onClick:e.onClose},n),e.onConfirm&&v("button",{id:"dp-modal-confirm",onClick:this.confirmClick},"okay"))))):null}}]),i}(),se=window.ga||function(){},ae=new(function(){function t(e){s(this,t),se("create",e,"auto","dubplusTracker")}return a(t,[{key:"event",value:function(e,t,n,o){se("dubplusTracker.send","event",e,t,n,o)}},{key:"menuClick",value:function(e,t,n){this.event(e,"click",t,n)}}]),t}())("UA-116652541-1"),ue=function(e){function i(){var e,t;s(this,i);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return u(l(l(t=d(this,(e=c(i)).call.apply(e,[this].concat(o))))),"state",{open:!1}),u(l(l(t)),"loadModal",function(){t.setState({open:!0}),ae.menuClick(t.props.section+" section",t.props.id+" edit")}),u(l(l(t)),"closeModal",function(){console.log("closing dub+ modal"),t.setState({open:!1})}),t}return n(i,G),a(i,[{key:"render",value:function(e,t){return v("span",{onClick:this.loadModal,className:"fa fa-pencil extra-icon"},v(ie,{open:t.open,title:e.title||"Dub+ option",content:e.content||"Please enter a value",placeholder:e.placeholder||"in here",value:e.value,onConfirm:e.onConfirm,onClose:this.closeModal}))}}]),i}(),ce=function(e){function i(){var e,t;s(this,i);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return u(l(l(t=d(this,(e=c(i)).call.apply(e,[this].concat(o))))),"state",{on:ne.stored.options[t.props.id]||!1}),u(l(l(t)),"switchOn",function(){t.props.turnOn(),ne.save("options",t.props.id,!0),t.setState({on:!0}),ae.menuClick(t.props.section+" section",t.props.id+" on")}),u(l(l(t)),"switchOff",function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];t.props.turnOff(),ne.save("options",t.props.id,!1),t.setState({on:!1}),e||ae.menuClick(t.props.section+" section",t.props.id+" off")}),u(l(l(t)),"toggleSwitch",function(){t.state.on?t.switchOff():t.switchOn()}),t}return n(i,G),a(i,[{key:"componentDidMount",value:function(){this.state.on&&this.props.turnOn()}},{key:"render",value:function(e,t){var n=["dubplus-switch"];return t.on&&n.push("dubplus-switch-on"),e.className&&n.push(e.className),v("li",{id:e.id,title:e.desc,className:n.join(" ")},e.children||null,v("div",{onClick:this.toggleSwitch,className:"dubplus-form-control"},v("div",{className:"dubplus-switch-bg"},v("div",{className:"dubplus-switcher"})),v("span",{className:"dubplus-menu-label"},e.menuTitle)))}}]),i}(),le=function(e){function i(){var e,r;s(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return u(l(l(r=d(this,(e=c(i)).call.apply(e,[this].concat(n))))),"state",{canSend:!0}),u(l(l(r)),"afk_chat_respond",function(e){if(r.state.canSend){var t=e.message,n=Dubtrack.session.get("username");if(-1<t.indexOf("@"+n)&&Dubtrack.session.id!==e.user.userInfo.userid){var o=document.getElementById("chat-txt-message");ne.stored.custom.customAfkMessage?o.value="[AFK] "+ne.stored.custom.customAfkMessage:o.value="[AFK] I'm not here right now.",Dubtrack.room.chat.sendMessage(),r.setState({canSend:!1}),setTimeout(function(){r.setState({canSend:!0})},3e4)}}}),r}return n(i,G),a(i,[{key:"turnOn",value:function(){Dubtrack.Events.bind("realtime:chat-message",this.afk_chat_respond)}},{key:"turnOff",value:function(){Dubtrack.Events.unbind("realtime:chat-message",this.afk_chat_respond)}},{key:"saveAFKmessage",value:function(e){""!==e&&ne.save("custom","customAfkMessage",e)}},{key:"render",value:function(e,t){return v(ce,{id:"dubplus-afk",section:"General",menuTitle:"AFK Auto-respond",desc:"Toggle Away from Keyboard and customize AFK message.",turnOn:this.turnOn,turnOff:this.turnOff},v(ue,{title:"Custom AFK Message",section:"General",content:"Enter a custom Away From Keyboard [AFK] message here",value:ne.stored.custom.customAfkMessage||"",placeholder:"Be right back!",maxlength:"255",onConfirm:this.saveAFKmessage}))}}]),i}(),de=function(e){function t(){var r;return s(this,t),u(l(l(r=d(this,c(t).call(this)))),"advance_vote",function(){var e=document.createEvent("HTMLEvents");e.initEvent("click",!0,!1),r.dubup.dispatchEvent(e)}),u(l(l(r)),"voteCheck",function(e){e.startTime<2&&r.advance_vote()}),u(l(l(r)),"turnOn",function(e){var t=Dubtrack.room.player.activeSong.get("song"),n=Dubtrack.helpers.cookie.get("dub-"+Dubtrack.room.model.get("_id")),o=Dubtrack.helpers.cookie.get("dub-song");Dubtrack.room&&t&&t.songid===o||(n=!1),r.dubup.classList.contains("voted")||r.dubdown.classList.contains("voted")||n||r.advance_vote(),Dubtrack.Events.bind("realtime:room_playlist-update",r.voteCheck)}),u(l(l(r)),"turnOff",function(e){Dubtrack.Events.unbind("realtime:room_playlist-update",r.voteCheck)}),r.dubup=document.querySelector(".dubup"),r.dubdown=document.querySelector(".dubdown"),r}return n(t,G),a(t,[{key:"render",value:function(e,t){return v(ce,{id:"dubplus-autovote",section:"General",menuTitle:"Autovote",desc:"Toggles auto upvoting for every song",turnOn:this.turnOn,turnOff:this.turnOff})}}]),t}();function pe(r){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(t,n){var o=new XMLHttpRequest;for(var e in i)i.hasOwnProperty(e)&&o.setRequestHeader(e,i[e]);o.onload=function(){try{var e=JSON.parse(o.responseText);t(e)}catch(e){n(e)}},o.onerror=function(){n()},o.open("GET",r),o.send()})}var fe=new function(){var r,e=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;if(!e)return console.error("indexDB not supported");var i=50,t=e.open("d2",1);return t.onsuccess=function(e){r=this.result},t.onerror=function(e){console.error("indexedDB request error",e)},t.onupgradeneeded=function(e){(r=this.result).createObjectStore("s",{keyPath:"k"}),r.transaction.oncomplete=function(e){r=e.target.db}},{get:function e(t,n){return!r&&0<=i?(setTimeout(function(){e(t,n)},100),void i--):(i=30,r.transaction("s").objectStore("s").get(t).onsuccess=function(e){var t=e.target.result&&e.target.result.v||null;n(t)})},set:function e(t,n){if(!r&&0<=i)return setTimeout(function(){e(t,n)},100),void i--;i=30;var o={k:t,v:n};r.transaction("s","readwrite").objectStore("s").put(o)}}};function he(r){return new Promise(function(o,e){fe.get(r+"_api",function(e){if(e)try{void 0!==JSON.parse(e).error&&o(!0)}catch(e){o(!0)}else o(!0);var t=Date.now(),n=parseInt(localStorage.getItem(r+"_api_timestamp"));o(isNaN(n)||6048e5<t-n)})})}var me=new(function(){function e(){var n=this;s(this,e),u(this,"specialEmotes",[]),u(this,"emotes",{}),u(this,"sortedKeys",{nonAlpha:[]}),u(this,"loaded",!1),u(this,"addKeyToSorted",function(e){var t=e.charAt(0);/[a-z]/i.test(t)?n.sortedKeys[t]?n.sortedKeys[t].push(e):n.sortedKeys[t]=[e]:n.sortedKeys.nonAlpha.push(e)})}return a(e,[{key:"load",value:function(){var t=this;return he("twitch").then(function(e){return e?t.updateFromApi():t.grabFromDb()})}},{key:"grabFromDb",value:function(){var o=this;return new Promise(function(n,t){try{fe.get("twitch_api",function(e){console.log("dub+","twitch","loading from IndexedDB");var t=JSON.parse(e);o.processEmotes(t),o.loaded="from db",t=null,n()})}catch(e){t(e)}})}},{key:"updateFromApi",value:function(){var n=this;console.log("dub+","twitch","loading from api");return pe("".concat("https://cors-escape.herokuapp.com","/https://api.twitch.tv/kraken/chat/emoticon_images")).then(function(e){var t={};e.emoticons.forEach(function(e){t[e.code]&&null!==e.emoticon_set||(t[e.code]=e.id)}),localStorage.setItem("twitch_api_timestamp",Date.now().toString()),fe.set("twitch_api",JSON.stringify(t)),n.processEmotes(t),n.loaded="from api"})}},{key:"template",value:function(e){return"//static-cdn.jtvnw.net/emoticons/v1/".concat(e,"/3.0")}},{key:"find",value:function(t){var n=this,e=t.charAt(0);return(/[a-z]/i.test(e)?this.sortedKeys[e]||[]:this.sortedKeys.nonAlpha).filter(function(e){return 0===e.indexOf(t)}).map(function(e){return{type:"twitch",src:n.template(n.emotes[e]),name:e}})}},{key:"processEmotes",value:function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=t.toLowerCase();if(0<=t.indexOf("\\")){this.specialEmotes.push([t,e[t]]);continue}if(0<=emojify.emojiNames.indexOf(n))continue;this.emotes[n]||(this.emotes[n]=e[t],this.addKeyToSorted(n))}}}]),e}()),ve=new(function(){function e(){var n=this;s(this,e),u(this,"emotes",{}),u(this,"sortedKeys",{nonAlpha:[]}),u(this,"loaded",!1),u(this,"headers",{}),u(this,"addKeyToSorted",function(e){var t=e.charAt(0);/[a-z]/i.test(t)?(n.sortedKeys[t]||(n.sortedKeys[t]=[]),n.sortedKeys[t].push(e)):n.sortedKeys.nonAlpha.push(e)})}return a(e,[{key:"optionalSetHeaders",value:function(e){this.headers=e}},{key:"load",value:function(){var t=this;return he("bttv").then(function(e){return e?t.updateFromAPI():t.loadFromDB()})}},{key:"loadFromDB",value:function(){var o=this;return new Promise(function(n,t){try{fe.get("bttv_api",function(e){console.log("dub+","bttv","loading from IndexedDB");var t=JSON.parse(e);o.processEmotes(t),t=null,n()})}catch(e){t(e)}})}},{key:"updateFromAPI",value:function(){var n=this;return console.log("dub+","bttv","loading from api"),pe("https://api.betterttv.net/2/emotes",this.headers).then(function(e){var t={};e.emotes.forEach(function(e){t[e.code]||(t[e.code]=e.id)}),localStorage.setItem("bttv_api_timestamp",Date.now().toString()),fe.set("bttv_api",JSON.stringify(t)),n.processEmotes(t)})}},{key:"template",value:function(e){return"//cdn.betterttv.net/emote/".concat(e,"/3x")}},{key:"find",value:function(t){var n=this,e=t.charAt(0);return(/[a-z]/i.test(e)?this.sortedKeys[e]||[]:this.sortedKeys.nonAlpha).filter(function(e){return 0===e.indexOf(t)}).map(function(e){return{type:"bttv",src:n.template(n.emotes[e]),name:e}})}},{key:"processEmotes",value:function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=t.toLowerCase();if(0<=t.indexOf(":"))continue;if(0<=emojify.emojiNames.indexOf(n))continue;0<=t.indexOf("(")&&(n=n.replace(/([()])/g,"")),this.emotes[n]=e[t],this.addKeyToSorted(n)}this.loaded=!0}}]),e}()),be=function(e){var t=e.data,n=e.onSelect;return v("li",{className:"preview-item ".concat(t.type,"-previews"),onClick:function(){return n(t.name)},tabIndex:"0"},v("div",{className:"ac-image"},v("img",{src:t.src,alt:t.name,title:t.name})),v("span",{className:"ac-text"},t.name))},ye=function(e){function t(){return s(this,t),d(this,c(t).apply(this,arguments))}return n(t,G),a(t,[{key:"getMatches",value:function(e){e=e.replace(/^:/,"");var t=me.find(e),n=ve.find(e);return t.concat(n)}},{key:"makeList",value:function(e){var n=this;return e.map(function(e,t){return v(be,{data:e,key:"".concat(e.type,"-").concat(e.name),onSelect:n.props.onSelect})})}},{key:"render",value:function(e){if(!e.symbol)return v("ul",{id:"autocomplete-preview"});var t=this.getMatches(e.symbol);return 0===t.length?v("ul",{id:"autocomplete-preview"}):v("ul",{id:"autocomplete-preview",className:"ac-show"},this.makeList(t))}}]),t}(),ge=38,we=40,ke=13,De=27,_e=9,Se=function(e){function i(){var e,r;s(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return u(l(l(r=d(this,(e=c(i)).call.apply(e,[this].concat(n))))),"state",{isOn:!1,symbol:""}),u(l(l(r)),"renderTo",document.querySelector(".pusher-chat-widget-input")),u(l(l(r)),"chatInput",document.getElementById("chat-txt-message")),u(l(l(r)),"navIndex",0),u(l(l(r)),"checkInput",function(e){var t=e.target.value.split(" ");if(0!==t.length){var n=t[t.length-1],o=n.charAt(n.length-1);":"===n.charAt(0)&&3<n.length&&":"!==o?r.setState({symbol:n}):""!==r.state.symbol&&r.closePreview()}}),u(l(l(r)),"updateChatInput",function(e){var t=r.chatInput.value.split(" ");t.pop(),t.push(":".concat(e,":")),r.chatInput.value=t.join(" "),r.chatInput.focus(),r.closePreview()}),u(l(l(r)),"keyboardNav",function(e){if(console.log("naving",r.state.symbol,r.previewList.length),r.state.symbol&&r.previewList&&0!==r.previewList.length)switch("which"in e?e.which:e.keyCode){case we:case _e:e.preventDefault(),r.navDown();case ge:e.preventDefault(),r.navUp();case ke:var t=document.querySelector(".preview-item.selected .ac-text").textContent.trim();r.updateChatInput(t);case De:r.closePreview(),r.chatInput.focus()}}),u(l(l(r)),"turnOn",function(e){r.setState({isOn:!0}),Dubtrack.room.chat.delegateEvents(_.omit(Dubtrack.room.chat.events,["keydown #chat-txt-message"])),r.chatInput.addEventListener("keyup",r.checkInput),r.chatInput.addEventListener("keydown",r.keyboardNav)}),u(l(l(r)),"turnOff",function(e){r.setState({isOn:!1}),Dubtrack.room.chat.delegateEvents(Dubtrack.room.chat.events),r.chatInput.removeEventListener("keyup",r.checkInput),r.chatInput.removeEventListener("keydown",r.keyboardNav)}),r}return n(i,G),a(i,[{key:"closePreview",value:function(){this.setState({symbol:""}),this.navIndex=-1}},{key:"clearSelected",value:function(){var e=document.querySelector(".preview-item.selected");e&&e.classList.remove("selected")}},{key:"navDown",value:function(){this.clearSelected(),this.navIndex++,this.navIndex>=this.previewList.length&&(this.navIndex=0);var e=this.previewList[this.navIndex];console.log(e),e.classList.add("selected"),e.scrollIntoView(),e.focus()}},{key:"navUp",value:function(){this.clearSelected(),this.navIndex--,this.navIndex<0&&(this.navIndex=this.previewList.length-1);var e=this.previewList[this.navIndex];console.log(e),e.classList.add("selected"),e.scrollIntoView(!0),e.focus()}},{key:"componentDidUpdate",value:function(e,t){this.state.isOn&&(this.previewList=document.querySelectorAll("#autocomplete-preview li"))}},{key:"render",value:function(e,t){var n=t.isOn,o=t.symbol;return v(ce,{id:"dubplus-emotes",section:"General",menuTitle:"Autocomplete Emoji",desc:"Quick find and insert emojis and emotes while typing in the chat input",turnOn:this.turnOn,turnOff:this.turnOff},n?v(oe,{into:this.renderTo},v(ye,{onSelect:this.updateChatInput,symbol:o})):null)}}]),i}();function Ce(e,t){var n=e.parentNode,r=e.nodeValue.trim(),l=document.createDocumentFragment(),i="-0wrap__emote0-";t.forEach(function(e){var t,n=(t=e.replace(/^:|:$/g,""),me.emotes[t]?{type:"twitch",src:me.template(me.emotes[t]),name:t}:!!ve.emotes[t]&&{type:"bttv",src:ve.template(ve.emotes[t]),name:t});if(n){var o=JSON.stringify(n);r=r.replace(e,"".concat(i).concat(o).concat(i))}}),r.split(i).forEach(function(t){try{var e=JSON.parse(t),n=(r=(o=e).type,i=o.src,s=o.name,a=o.w,u=o.h,c=document.createElement("img"),a&&(c.width=a),u&&(c.height=u),c.className="emoji ".concat(r,"-emote"),c.title=s,c.alt=s,c.src=i,c);l.appendChild(n)}catch(e){l.appendChild(document.createTextNode(t))}var o,r,i,s,a,u,c}),n.replaceChild(l,e)}function Oe(e){var t;(e.nodeType||(e=0<(t=document.querySelectorAll(".chat-main .text")).length?t[t.length-1]:null),e)&&function(e){for(var t,n=[],o=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);t=o.nextNode();)n.push(t);return n}(e).forEach(function(e){var t=e.nodeValue.trim();if(""!==t){var n=function(e){var t=[],n="",o=!1,r=0;function i(){n="",o=!1}function s(e){n+=e}for(;r<e.length;){var a=e.charAt(r);if(o||":"!==a){if(o){if(":"===a){s(a),"::"!==n&&t.push(n),i(),r++;continue}if(" "===a){i(),r++;continue}s(a)}r++}else o=!0,s(a),r++}return t}(t);0!==n.length&&Ce(e,n)}})}var xe=function(e){function i(){var e,t;s(this,i);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return u(l(l(t=d(this,(e=c(i)).call.apply(e,[this].concat(o))))),"turnOn",function(){me.loaded?t.begin():Promise.all([me.load(),ve.load()]).then(t.begin).catch(function(e){console.error(e)})}),u(l(l(t)),"turnOff",function(e){Dubtrack.Events.unbind("realtime:chat-message",Oe)}),t}return n(i,G),a(i,[{key:"begin",value:function(){Oe(document.querySelector(".chat-main")),Dubtrack.Events.bind("realtime:chat-message",Oe)}},{key:"render",value:function(e,t){return v(ce,{id:"dubplus-emotes",section:"General",menuTitle:"Emotes",desc:"Adds twitch and bttv emotes in chat.",turnOn:this.turnOn,turnOff:this.turnOff})}}]),i}(),Ne=function(e){function i(){var e,t;s(this,i);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return u(l(l(t=d(this,(e=c(i)).call.apply(e,[this].concat(o))))),"customMentionCheck",function(e){var t=e.message;if(ne.custom.custom_mentions){var n=ne.custom.custom_mentions.split(",").some(function(e){return new RegExp("\\b"+e.trim()+"\\b","i").test(t)});Dubtrack.session.id!==e.user.userInfo.userid&&n&&Dubtrack.room.chat.mentionChatSound.play()}}),u(l(l(t)),"saveCustomMentions",function(e){""!==e&&ne.save("custom","custom_mentions",e)}),t}return n(i,G),a(i,[{key:"turnOn",value:function(){Dubtrack.Events.bind("realtime:chat-message",this.customMentionCheck)}},{key:"turnOff",value:function(){Dubtrack.Events.unbind("realtime:chat-message",this.customMentionCheck)}},{key:"render",value:function(e,t){return v(ce,{id:"custom_mentions",section:"General",menuTitle:"Custom Mentions",desc:"Toggle using custom mentions to trigger sounds in chat",turnOn:this.turnOn,turnOff:this.turnOff},v(ue,{title:"Custom AFK Message",section:"General",content:"Add your custom mention triggers here (separate by comma)",value:ne.stored.custom.custom_mentions||"",placeholder:"separate, custom triggers, by, comma, :heart:",maxlength:"255",onConfirm:this.saveCustomMentions}))}}]),i}(),Ee=function(e){function i(){var e,t;s(this,i);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return u(l(l(t=d(this,(e=c(i)).call.apply(e,[this].concat(o))))),"chatCleanerCheck",function(e){var t=Array.from(document.querySelectorAll("ul.chat-main > li")),n=parseInt(ne.stored.custom.chat_cleaner,10);if(!(isNaN(t.length)||isNaN(n)||!t.length||t.length<n)){var o=t[0].parentElement;t.slice(0,n).forEach(function(e,t){o.removeChild(e)}),$(".chat-messages").perfectScrollbar("update")}}),u(l(l(t)),"saveAmount",function(e){var t=parseInt(e,10),n=isNaN(t)?500:t;ne.save("custom","chat_cleaner",n)}),u(l(l(t)),"turnOn",function(){Dubtrack.Events.bind("realtime:chat-message",t.chatCleanerCheck)}),u(l(l(t)),"turnOff",function(){Dubtrack.Events.unbind("realtime:chat-message",t.chatCleanerCheck)}),t}return n(i,G),a(i,[{key:"render",value:function(){return v(ce,{id:"chat-cleaner",section:"General",menuTitle:"Chat Cleaner",desc:"Automatically only keep a designated chatItems of chat items while clearing older ones, keeping CPU stress down",turnOn:this.turnOn,turnOff:this.turnOff},v(ue,{title:"Chat Cleaner",section:"General",content:"Please specify the number of most recent chat items that will remain in your chat history",value:ne.stored.custom.chat_cleaner||"",placeholder:"500",maxlength:"5",onConfirm:this.saveAmount}))}}]),i}(),Te=!0,Ae={denyDismiss:{title:"Desktop Notifications",content:"You have dismissed or chosen to deny the request to allow desktop notifications. Reset this choice by clearing your cache for the site."},noSupport:{title:"Desktop Notifications",content:"Sorry this browser does not support desktop notifications.  Please use the latest version of Chrome or FireFox"}};function Me(e){var t="function"==typeof e?e:function(){};return"Notification"in window?"granted"===Notification.permission?t(!0,"granted"):"denied"===Notification.permission?t(!1,Ae.denyDismiss):void Notification.requestPermission().then(function(e){if("denied"!==e&&"default"!==e)return t(!0,"granted");t(!1,Ae.denyDismiss)}):t(!1,Ae.noSupport)}function Ie(e){var t=Object.assign({},{title:"New Message",content:"",ignoreActiveTab:!1,callback:null,wait:5e3},e);if(!0!==Te||t.ignoreActiveTab){var n={body:t.content,icon:"https://res.cloudinary.com/hhberclba/image/upload/c_lpad,h_100,w_100/v1400351432/dubtrack_new_logo_fvpxa6.png"},o=new Notification(t.title,n);o.onclick=function(){window.focus(),"function"==typeof t.callback&&t.callback(),o.close()},setTimeout(o.close.bind(o),t.wait)}}window.onfocus=function(){Te=!0},window.onblur=function(){Te=!1};var Pe=function(e){function i(){var e,n;s(this,i);for(var t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return u(l(l(n=d(this,(e=c(i)).call.apply(e,[this].concat(o))))),"state",{showWarning:!1,warnTitle:"",warnContent:""}),u(l(l(n)),"turnOn",function(){Me(function(e,t){!0===e?Dubtrack.Events.bind("realtime:chat-message",n.notifyOnMention):(n.switchRef.switchOff(!0),n.setState({showWarning:!0,warnTitle:t.title,warnContent:t.content}))})}),u(l(l(n)),"closeModal",function(){n.setState({showWarning:!1})}),u(l(l(n)),"turnOff",function(){Dubtrack.Events.unbind("realtime:chat-message",n.notifyOnMention)}),n}return n(i,G),a(i,[{key:"notifyOnMention",value:function(e){var t=e.message,n=["@"+Dubtrack.session.get("username").toLowerCase()];ne.stored.options.custom_mentions&&ne.stored.custom.custom_mentions&&(n=n.concat(ne.stored.custom.custom_mentions.split(","))),n.some(function(e){return new RegExp("\\b"+e.trim()+"\\b","i").test(t)})&&!this.isActiveTab&&Dubtrack.session.id!==e.user.userInfo.userid&&Ie({title:"Message from ".concat(e.user.username),content:t})}},{key:"render",value:function(e,t){var n=this;return v(ce,{ref:function(e){return n.switchRef=e},id:"mention_notifications",section:"General",menuTitle:"Notification on Mentions",desc:"Enable desktop notifications when a user mentions you in chat",turnOn:this.turnOn,turnOff:this.turnOff},v(ie,{open:t.showWarning,title:t.warnTitle,content:t.warnContent,onClose:this.closeModal}))}}]),i}(),Le=function(e){function i(){var e,n;s(this,i);for(var t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return u(l(l(n=d(this,(e=c(i)).call.apply(e,[this].concat(o))))),"state",{showWarning:!1,warnTitle:"",warnContent:""}),u(l(l(n)),"turnOn",function(){Me(function(e,t){!0===e?Dubtrack.Events.bind("realtime:new-message",n.notify):(n.switchRef.switchOff(!0),n.setState({showWarning:!0,warnTitle:t.title,warnContent:t.content}))})}),u(l(l(n)),"closeModal",function(){n.setState({showWarning:!1})}),u(l(l(n)),"turnOff",function(){Dubtrack.Events.unbind("realtime:new-message",n.notify)}),n}return n(i,G),a(i,[{key:"notify",value:function(e){Dubtrack.session.get("_id")!==e.userid&&Ie({title:"You have a new PM",ignoreActiveTab:!0,callback:function(){document.querySelector(".user-messages").click(),setTimeout(function(){document.querySelector('.message-item[data-messageid="'.concat(e.messageid,'"]')).click()},500)},wait:1e4})}},{key:"render",value:function(e,t){var n=this;return v(ce,{ref:function(e){return n.switchRef=e},id:"dubplus_pm_notifications",section:"General",menuTitle:"Notification on PM",desc:"Enable desktop notifications when a user receives a private message",turnOn:this.turnOn,turnOff:this.turnOff},v(ie,{open:t.showWarning,title:t.warnTitle,content:t.warnContent,onClose:this.closeModal}))}}]),i}(),We=function(e){function i(){var e,r;s(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return u(l(l(r=d(this,(e=c(i)).call.apply(e,[this].concat(n))))),"state",{canNotify:!1}),u(l(l(r)),"savePosition",function(e){var t=parseInt(e,10),n=isNaN(t)?2:t;ne.save("custom","dj_notification",n)}),u(l(l(r)),"djNotificationCheck",function(e){if(!(2<e.startTime)){var t=document.querySelector(".queue-position").textContent,n=parseInt(t,10),o=e.startTime<0&&!isNaN(n)?n-1:n;isNaN(n)||o!==ne.stored.custom.dj_notification||(r.canNotify&&Ie({title:"DJ Alert!",content:"You will be DJing shortly! Make sure your song is set!",ignoreActiveTab:!0,wait:1e4}),Dubtrack.room.chat.mentionChatSound.play())}}),u(l(l(r)),"turnOn",function(){Me(function(e,t){!0===e&&r.setState({canNotify:!0})}),Dubtrack.Events.bind("realtime:room_playlist-update",r.djNotificationCheck)}),u(l(l(r)),"turnOff",function(){Dubtrack.Events.unbind("realtime:room_playlist-update",r.djNotificationCheck)}),r}return n(i,G),a(i,[{key:"render",value:function(e,t){var n=this;return v(ce,{ref:function(e){return n.switchRef=e},id:"dj-notification",section:"General",menuTitle:"DJ Notification",desc:"Notification when you are coming up to be the DJ",turnOn:this.turnOn,turnOff:this.turnOff},v(ue,{title:"DJ Notification",section:"General",content:"Please specify the position in queue you want to be notified at",value:ne.stored.custom.dj_notification||"",placeholder:"2",maxlength:"2",onConfirm:this.savePosition}))}}]),i}(),qe=function(e){function i(){var e,t;s(this,i);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return u(l(l(t=d(this,(e=c(i)).call.apply(e,[this].concat(o))))),"turnOn",function(){$.snowfall?t.doSnow():Y("https://cdn.jsdelivr.net/gh/loktar00/JQuery-Snowfall/src/snowfall.jquery.js",function(e){if(e)return t.switchRef.switchOff(!0),void console.error("Could not load snowfall jquery plugin",e);t.doSnow()})}),t}return n(i,G),a(i,[{key:"doSnow",value:function(){$(document).snowfall({round:!0,shadow:!0,flakeCount:50,minSize:1,maxSize:5,minSpeed:5,maxSpeed:5})}},{key:"turnOff",value:function(){$.snowfall&&$(document).snowfall("clear")}},{key:"render",value:function(){var t=this;return v(ce,{ref:function(e){return t.switchRef=e},id:"dubplus-snow",section:"General",menuTitle:"Snow",desc:"Make it snow!",turnOn:this.turnOn,turnOff:this.turnOff})}}]),i}(),je={particles:[],drops:[],numbase:5,numb:2,height:0,controls:{rain:2,alpha:1,color:200,opacity:1,saturation:100,lightness:50,back:0,multi:!1,speed:1},init:function(){var e=document.createElement("canvas");e.id="dubPlusRainCanvas",e.style.cssText="position : fixed; top : 0px; left : 0px; z-index: 100; pointer-events:none;",document.body.insertBefore(e,document.body.childNodes[0]),this.bindCanvas()},destroy:function(){document.body.removeChild(document.getElementById("dubPlusRainCanvas")),this.unbindCanvas()},bindCanvas:function(){this.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};var e=document.getElementById("dubPlusRainCanvas");if(e){var t=e.getContext("2d");this.width,this.height=0,window.onresize=function(){this.width=e.width=window.innerWidth,this.height=e.height=window.innerHeight},window.onresize(),this.particles,this.drops=[],this.numbase=5,this.numb=2;var n=this;!function e(){n.requestAnimFrame(e),n.update(),n.rendu(t)}()}},buildRainParticle:function(e,t,n){for(n||(n=this.numb);n--;)this.particles.push({speedX:.25*Math.random(),speedY:9*Math.random()+1,X:e,Y:t,alpha:1,color:"hsla("+this.controls.color+","+this.controls.saturation+"%, "+this.controls.lightness+"%,"+this.controls.opacity+")"})},explosion:function(e,t,n,o){for(o||(o=this.numbase);o--;)this.drops.push({speedX:4*Math.random()-2,speedY:-4*Math.random(),X:e,Y:t,radius:.65+Math.floor(1.6*Math.random()),alpha:1,color:n})},rendu:function(e){1==this.controls.multi&&(this.controls.color=360*Math.random()),e.save(),e.clearRect(0,0,width,height);for(var t,n=this.particles,o=this.drops,r=2*Math.PI,i=0;t=n[i];i++)e.globalAlpha=t.alpha,e.fillStyle=t.color,e.fillRect(t.X,t.Y,t.speedY/4,t.speedY);var s;for(i=0;s=o[i];i++)e.globalAlpha=s.alpha,e.fillStyle=s.color,e.beginPath(),e.arc(s.X,s.Y,s.radius,0,r),e.fill();e.strokeStyle="white",e.lineWidth=2,e.restore()},update:function(){for(var e,t=this.particles,n=this.drops,o=0;e=t[o];o++)e.X+=e.speedX,e.Y+=e.speedY+5,e.Y>height-15&&(t.splice(o--,1),this.explosion(e.X,e.Y,e.color));var r;for(o=0;r=n[o];o++)r.X+=r.speedX,r.Y+=r.speedY,r.radius-=.075,0<r.alpha?r.alpha-=.005:r.alpha=0,r.radius<0&&n.splice(o--,1);for(o=this.controls.rain;o--;)this.buildRainParticle(Math.floor(Math.random()*width),-15)},unbindCanvas:function(){this.requestAnimFrame=function(){}}},Re=function(e){function t(){return s(this,t),d(this,c(t).apply(this,arguments))}return n(t,G),a(t,[{key:"turnOn",value:function(){je.init()}},{key:"turnOff",value:function(){je.destroy()}},{key:"render",value:function(e,t){return v(ce,{id:"dubplus-rain",section:"General",menuTitle:"Rain",desc:"Make it rain!",turnOn:this.turnOn,turnOff:this.turnOff})}}]),t}();function Fe(e){return Dubtrack.helpers.isDubtrackAdmin(e)||Dubtrack.room.users.getIfOwner(e)||Dubtrack.room.users.getIfManager(e)||Dubtrack.room.users.getIfMod(e)}var Be=function(e){var t=e.data,n=e.click;return v("li",{onClick:function(){return n("@"+t.username+" ")},className:"dubinfo-preview-item"},v("div",{className:"dubinfo-image"},v("img",{src:"https://api.dubtrack.fm/user/".concat(t.userid,"/image")})),v("span",{className:"dubinfo-text"},"@",t.username))},Ue=function(e){function t(){return s(this,t),d(this,c(t).apply(this,arguments))}return n(t,G),a(t,[{key:"getBgColor",value:function(){var e,t=this.props.type.replace("dubs","");if("up"===t)e=document.querySelector(".dubup");else{if("down"!==t)return;e=document.querySelector(".dubdown")}return e.classList.contains("voted")?window.getComputedStyle(e).backgroundColor:window.getComputedStyle(e.querySelector(".icon-".concat(t,"vote"))).color}},{key:"updateChat",value:function(e){var t=document.getElementById("chat-txt-message");t.value=e,t.focus()}},{key:"makeList",value:function(){var n=this;return this.props.dubs.map(function(e,t){return v(Be,{data:e,click:n.updateChat,key:"info-".concat(n.props.type,"-").concat(t)})})}},{key:"render",value:function(e){var t=e.type,n=e.isMod,o="No ".concat(t," have been casted yet!");"grabs"===t&&(o="This song hasn't been grabbed yet!");var r=this.makeList(),i=["dubinfo-preview","dubinfo-".concat(t)];return 0===r.length&&(r=v("li",{className:"dubinfo-preview-none"},o),i.push("dubinfo-no-dubs")),"downdubs"!==t||n||i.push("dubinfo-unauthorized"),v("ul",{style:{borderColor:this.getBgColor()},className:i.join(" ")},r)}}]),t}(),ze=function(e){function r(){var e,i;s(this,r);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return u(l(l(i=d(this,(e=c(r)).call.apply(e,[this].concat(n))))),"state",{isOn:!1,showWarning:!0,upDubs:[],downDubs:[],grabs:[]}),u(l(l(i)),"userIsMod",Fe(Dubtrack.session.id)),u(l(l(i)),"turnOn",function(){i.setState({isOn:!0},i.resetDubs),Dubtrack.Events.bind("realtime:room_playlist-dub",i.dubWatcher),Dubtrack.Events.bind("realtime:room_playlist-queue-update-grabs",i.grabWatcher),Dubtrack.Events.bind("realtime:user-leave",i.dubUserLeaveWatcher),Dubtrack.Events.bind("realtime:room_playlist-update",i.resetDubs),Dubtrack.Events.bind("realtime:room_playlist-update",i.resetGrabs)}),u(l(l(i)),"turnOff",function(){i.setState({isOn:!1}),Dubtrack.Events.unbind("realtime:room_playlist-dub",i.dubWatcher),Dubtrack.Events.unbind("realtime:room_playlist-queue-update-grabs",i.grabWatcher),Dubtrack.Events.unbind("realtime:user-leave",i.dubUserLeaveWatcher),Dubtrack.Events.unbind("realtime:room_playlist-update",i.resetDubs),Dubtrack.Events.unbind("realtime:room_playlist-update",i.resetGrabs)}),u(l(l(i)),"closeModal",function(){i.setState({showWarning:!1})}),u(l(l(i)),"dubWatcher",function(t){var e=i.state,n=e.upDubs,o=e.downDubs,r={userid:t.user._id,username:t.user.username};"updub"===t.dubtype&&(0===n.filter(function(e){return e.userid===t.user._id}).length&&i.setState(function(e){return{upDubs:[].concat(p(e.upDubs),[r])}}),0<o.filter(function(e){return e.userid===t.user._id}).length&&i.setState(function(e){return{downDubs:e.downDubs.filter(function(e){return e.userid!==t.user._id})}}));"downdub"===t.dubtype&&(0===o.filter(function(e){return e.userid===t.user._id}).length&&i.userIsMod&&i.setState(function(e){return{downDubs:[].concat(p(e.downDubs),[r])}}),0<n.filter(function(e){return e.userid===t.user._id}).length&&i.setState(function(e){return{upDubs:e.upDubs.filter(function(e){return e.userid!==t.user._id})}}))}),u(l(l(i)),"grabWatcher",function(t){if(i.state.grabs.filter(function(e){return e.userid===t.user._id}).length<=0){var n={userid:t.user._id,username:t.user.username};i.setState(function(e){return{grabs:[].concat(p(e.grabs),[n])}})}}),u(l(l(i)),"dubUserLeaveWatcher",function(t){var e=i.state.upDubs.filter(function(e){return e.userid!==t.user._id}),n=i.state.downDubs.filter(function(e){return e.userid!==t.user._id}),o=i.state.grabs.filter(function(e){return e.userid!==t.user._id});i.setState({upDubs:e,downDubs:n,grabs:o})}),u(l(l(i)),"resetDubs",function(){i.setState({upDubs:[],downDubs:[]},i.handleReset)}),u(l(l(i)),"resetGrabs",function(){i.setState({grabs:[]})}),i}return n(r,G),a(r,[{key:"handleReset",value:function(){var r=this;pe("https://api.dubtrack.fm/room/".concat(Dubtrack.room.model.id,"/playlist/active/dubs")).then(function(e){e.data&&e.data.upDubs&&e.data.upDubs.forEach(function(o){if(!(0<r.state.upDubs.filter(function(e){return e.userid===o.userid}).length)){var e=Dubtrack.room.users.collection.findWhere({userid:o.userid});if(e&&e.attributes){if(e.attributes._user.username){var t={userid:o.userid,username:e.attributes._user.username};r.setState(function(e){return{upDubs:[].concat(p(e.upDubs),[t])}})}}else pe("https://api.dubtrack.fm/user/"+o.userid).then(function(e){var t=e.data;if(t&&t.userinfo&&t.userinfo.username){var n={userid:o.userid,username:t.userinfo.username};r.setState(function(e){return{upDubs:[].concat(p(e.upDubs),[n])}})}})}}),e.data&&e.data.downDubs&&r.userIsMod&&e.data.downDubs.forEach(function(o){if(!(0<r.state.downDubs.filter(function(e){return e.userid===o.userid}).length)){var e=Dubtrack.room.users.collection.findWhere({userid:o.userid});if(e&&e.attributes){if(e.attributes._user.username){var t={userid:o.userid,username:e.attributes._user.username};r.setState(function(e){return{downDubs:[].concat(p(e.downDubs),[t])}})}}else pe("https://api.dubtrack.fm/user/"+o.userid).then(function(e){var t=e.data;if(t&&t.userinfo&&t.userinfo.username){var n={userid:o.userid,username:t.userinfo.username};r.setState(function(e){return{downDubs:[].concat(p(e.downDubs),[n])}})}})}})})}},{key:"componentWillMount",value:function(){this.upElem=document.querySelector(".dubup").parentElement,this.upElem.classList.add("dubplus-updub-btn"),this.downElem=document.querySelector(".dubdown").parentElement,this.downElem.classList.add("dubplus-downdub-btn"),this.grabElem=document.querySelector(".add-to-playlist-button").parentElement,this.grabElem.classList.add("dubplus-grab-btn")}},{key:"render",value:function(e,t){return v(ce,{id:"dubplus-dubs-hover",section:"General",menuTitle:"Show Dub info on Hover",desc:"Show Dub info on Hover.",turnOn:this.turnOn,turnOff:this.turnOff},v(ie,{open:t.showWarning,title:"Vote & Grab Info",content:"Please note that this feature is currently still in development. We are waiting on the ability to pull grab vote information from Dubtrack on load. Until then the only grabs you will be able to see are those you are present in the room for.",onClose:this.closeModal}),t.isOn?v("span",null,v(oe,{into:this.upElem},v(Ue,{type:"updubs",dubs:t.upDubs})),v(oe,{into:this.downElem},v(Ue,{type:"downdubs",isMod:this.userIsMod,dubs:t.downDubs})),v(oe,{into:this.grabElem},v(Ue,{type:"grabs",dubs:t.grabs}))):null)}}]),r}();var Ge=function(e){function t(){return s(this,t),d(this,c(t).apply(this,arguments))}return n(t,G),a(t,[{key:"turnOn",value:function(){Fe(Dubtrack.session.id)&&Dubtrack.Events.bind("realtime:room_playlist-dub",this.downdubWatcher)}},{key:"turnOff",value:function(){Dubtrack.Events.unbind("realtime:room_playlist-dub",this.downdubWatcher)}},{key:"downdubWatcher",value:function(e){if(Dubtrack.session.get("username")===Dubtrack.room.users.collection.findWhere({userid:Dubtrack.room.player.activeSong.attributes.song.userid}).attributes._user.username&&"downdub"===e.dubtype){var t=function(e,t){var n=document.createElement("li");n.className="dubplus-chat-system dubplus-chat-system-downdub";var o=document.createElement("div");o.className="chatDelete",o.onclick=function(e){return e.currentTarget.parentElement.remove()};var r=document.createElement("span");r.className="icon-close";var i=document.createElement("div");return i.className="text",i.textContent="@".concat(e," has downdubbed your song ").concat(t),o.appendChild(r),n.appendChild(o),n.appendChild(i),n}(e.user.username,Dubtrack.room.player.activeSong.attributes.songInfo.name);document.querySelector("ul.chat-main").appendChild(t)}}},{key:"render",value:function(){return v(ce,{id:"dubplus-downdubs",section:"General",menuTitle:"Downdubs in Chat (mods only)",desc:"Toggle showing downdubs in the chat box (mods only)",turnOn:this.turnOn,turnOff:this.turnOff})}}]),t}();var Ke=function(e){function t(){return s(this,t),d(this,c(t).apply(this,arguments))}return n(t,G),a(t,[{key:"turnOn",value:function(){Dubtrack.Events.bind("realtime:room_playlist-dub",this.updubWatcher)}},{key:"turnOff",value:function(){Dubtrack.Events.unbind("realtime:room_playlist-dub",this.updubWatcher)}},{key:"updubWatcher",value:function(e){if(Dubtrack.session.get("username")===Dubtrack.room.users.collection.findWhere({userid:Dubtrack.room.player.activeSong.attributes.song.userid}).attributes._user.username&&"updub"===e.dubtype){var t=function(e,t){var n=document.createElement("li");n.className="dubplus-chat-system dubplus-chat-system-updub";var o=document.createElement("div");o.className="chatDelete",o.onclick=function(e){return e.currentTarget.parentElement.remove()};var r=document.createElement("span");r.className="icon-close";var i=document.createElement("div");return i.className="text",i.textContent="@".concat(e," has updubbed your song ").concat(t),o.appendChild(r),n.appendChild(o),n.appendChild(i),n}(e.user.username,Dubtrack.room.player.activeSong.attributes.songInfo.name);document.querySelector("ul.chat-main").appendChild(t)}}},{key:"render",value:function(){return v(ce,{id:"dubplus-updubs",section:"General",menuTitle:"Updubs in Chat",desc:"Toggle showing updubs in the chat box",turnOn:this.turnOn,turnOff:this.turnOff})}}]),t}();var Ye=function(e){function t(){return s(this,t),d(this,c(t).apply(this,arguments))}return n(t,G),a(t,[{key:"turnOn",value:function(){Dubtrack.Events.bind("realtime:room_playlist-queue-update-grabs",this.grabChatWatcher)}},{key:"turnOff",value:function(){Dubtrack.Events.unbind("realtime:room_playlist-queue-update-grabs",this.grabChatWatcher)}},{key:"grabChatWatcher",value:function(e){if(Dubtrack.session.get("username")===Dubtrack.room.users.collection.findWhere({userid:Dubtrack.room.player.activeSong.attributes.song.userid}).attributes._user.username&&!Dubtrack.room.model.get("displayUserGrab")){var t=function(e,t){var n=document.createElement("li");n.className="dubplus-chat-system dubplus-chat-system-grab";var o=document.createElement("div");o.className="chatDelete",o.onclick=function(e){return e.currentTarget.parentElement.remove()};var r=document.createElement("span");r.className="icon-close";var i=document.createElement("div");return i.className="text",i.textContent="@".concat(e," has grabbed your song ").concat(t),o.appendChild(r),n.appendChild(o),n.appendChild(i),n}(e.user.username,Dubtrack.room.player.activeSong.attributes.songInfo.name);document.querySelector("ul.chat-main").appendChild(t)}}},{key:"render",value:function(){return v(ce,{id:"dubplus-grabschat",section:"General",menuTitle:"Grabs in Chat",desc:"Toggle showing grabs in the chat box",turnOn:this.turnOn,turnOff:this.turnOff})}}]),t}(),He=function(e){function i(){var e,t;s(this,i);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return u(l(l(t=d(this,(e=c(i)).call.apply(e,[this].concat(o))))),"state",{section:ne.stored.general||"open"}),u(l(l(t)),"toggleSection",function(e){t.setState(function(e){var t="open"===e.section?"closed":"open";return ne.save("menu","general",t),{section:t}})}),t}return n(i,G),a(i,[{key:"render",value:function(e,t){var n=["dubplus-menu-section"];return"closed"===t.section&&n.push("dubplus-menu-section-closed"),v("span",null,v(ee,{onClick:this.toggleSection,id:"dubplus-general",category:"General",open:t.section}),v("ul",{className:n.join(" ")},v(de,null),v(le,null),v(Se,null),v(xe,null),v(Ne,null),v(Ee,null),v(Pe,null),v(Le,null),v(We,null),v(ze,null),v(Ge,null),v(Ke,null),v(Ye,null),v(qe,null),v(Re,null)))}}]),i}(),Ve=function(e){function t(){return s(this,t),d(this,c(t).apply(this,arguments))}return n(t,G),a(t,[{key:"componentDidMount",value:function(){setTimeout(function(){K(v(X,null),document.querySelector(".player_sharing")),K(v(Z,null),document.querySelector(".player_sharing"))},10)}},{key:"render",value:function(e,t){return v("section",{className:"dubplus-menu"},v("p",{className:"dubplus-menu-header"},"Dub+ Options"),v(He,null))}}]),t}();function Je(e,t){for(var n=e.split("."),o=n.length,r=t||window,i=0;i<o;i++){if(void 0===r[n[i]])return!1;r=r[n[i]]}return!0}function Xe(e,t){for(var n=e.length,o=t||window,r=0;r<n;r++)if(!Je(e[r],o))return console.log(e[r],"is not found yet"),!1;return!0}function $e(t,e){if("string"==typeof t||Array.isArray(t)){var n=function(){},o=function(){},r=Array.isArray(t)?Xe:Je,i=Object.assign({},{interval:500,seconds:15},e),s=0,a=1e3*i.seconds/i.interval,u=function e(){return s++,r(t)?n():s<a?void window.setTimeout(e,i.interval):o()};return{then:function(e){return"function"==typeof e&&(n=e),window.setTimeout(u,i.interval),this},fail:function(e){return"function"==typeof e&&(o=e),this}}}console.warn("WaitFor: invalid first argument")}var Qe={fontFamily:"'Trebuchet MS', Helvetica, sans-serif",zIndex:"2147483647",color:"white",position:"fixed",top:"69px",right:"-250px",background:"#222",padding:"10px",lineHeight:1,boxShadow:"0px 0px 5px 0px rgba(0,0,0,0.75)",borderRadius:"5px",overflow:"hidden",width:"230px",transition:"right 200ms"},Ze={float:"left",width:"26px",marginRight:"5px"},et={display:"table-cell",width:"10000px",paddingTop:"5px"},tt=function(e){function i(){var e,t;s(this,i);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return u(l(l(t=d(this,(e=c(i)).call.apply(e,[this].concat(o))))),"state",{mainStyles:Qe}),t}return n(i,G),a(i,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.setState(function(e,t){return{mainStyles:Object.assign({},e.mainStyles,{right:"13px"})}})},200)}},{key:"componentWillUnmount",value:function(){this.setState(function(e,t){return{mainStyles:Object.assign({},e.mainStyles,{right:"-250px"})}})}},{key:"render",value:function(e,t){return v("div",{style:t.mainStyles},v("div",{style:Ze},v("img",{src:ne.srcRoot+"/images/dubplus.svg",alt:"DubPlus icon"})),v("span",{style:et},e.text||"Waiting for Dubtrack..."))}}]),i}(),nt=function(e,t){var n=document.createElement("link");return n.rel="stylesheet",n.type="text/css",n.className=e||"",n.href=t,n};var ot={load:function(e,t){if(e){var n=nt(t,ne.srcRoot+e+"?1548684509344");document.head.appendChild(n)}},loadExternal:function(e,t){if(e){var n=nt(t,e);document.head.appendChild(n)}}},rt=function(e){function i(){var e,t;s(this,i);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return u(l(l(t=d(this,(e=c(i)).call.apply(e,[this].concat(o))))),"state",{open:!1}),u(l(l(t)),"toggle",function(){var e=document.querySelector(".dubplus-menu");t.state.open?(e.classList.remove("dubplus-menu-open"),t.setState({open:!1})):(e.classList.add("dubplus-menu-open"),t.setState({open:!0}))}),t}return n(i,G),a(i,[{key:"render",value:function(e,t){return v("div",{className:"dubplus-icon",onClick:this.toggle},v("img",{src:"".concat(ne.srcRoot,"/images/dubplus.svg"),alt:"DubPlus Icon"}))}}]),i}();[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){null!==this.parentNode&&this.parentNode.removeChild(this)}})}),"undefined"==typeof Promise&&Y("https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js"),setTimeout(function(){ot.loadExternal("https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"),ot.load("/css/dubplus.css")},1),K(v(function(e){function i(){var e,t;s(this,i);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return u(l(l(t=d(this,(e=c(i)).call.apply(e,[this].concat(o))))),"state",{loading:!0,error:!1,errorMsg:"",failed:!1}),t}return n(i,G),a(i,[{key:"componentDidMount",value:function(){var e=this;if(window.DubPlus)Dubtrack.session.id?this.showError("Dub+ is already loaded"):this.showError("You're not logged in. Please login to use Dub+.");else{new $e(["Dubtrack.session.id","Dubtrack.room.chat","Dubtrack.Events","Dubtrack.room.player","Dubtrack.helpers.cookie","Dubtrack.room.model","Dubtrack.room.users"],{seconds:120}).then(function(){e.setState({loading:!1,error:!1})}).fail(function(){Dubtrack.session.id?(e.showError("Something happed, refresh and try again"),ae.event("Dub+ lib","load","failed")):e.showError("You're not logged in. Please login to use Dub+.")})}}},{key:"showError",value:function(e){this.setState({loading:!1,error:!0,errorMsg:e})}},{key:"render",value:function(e,t){var n=this;return t.loading?v(tt,null):t.error?v(ie,{title:"Dub+ Error",onClose:function(){n.setState({failed:!0,error:!1})},content:t.errorMsg}):t.failed?null:(document.querySelector("html").classList.add("dubplus"),v(Ve,null))}}]),i}(),null),document.body),K(v(rt,null),document.querySelector(".header-right-navigation"));return{version:"2.0.0",description:"Dub+ - A simple script/extension for Dubtrack.fm",license:"MIT",bugs:"https://github.com/DubPlus/DubPlus/issues"}}();
